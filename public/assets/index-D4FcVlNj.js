const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-edTm9vRp.js","assets/pdf-C06UDWxx.js","assets/vendor-W07s9AD9.js","assets/ui-DWVAqNqj.js","assets/charts-DvSD_8Tn.js","assets/Register-CEdC8mq8.js","assets/EditProfile-y_hD3dT9.js","assets/Credits-DW5icCfA.js"])))=>i.map(i=>d[i]);
var mt=Object.defineProperty,ut=Object.defineProperties;var xt=Object.getOwnPropertyDescriptors;var ze=Object.getOwnPropertySymbols;var ht=Object.prototype.hasOwnProperty,pt=Object.prototype.propertyIsEnumerable;var Ue=(o,t,r)=>t in o?mt(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,Q=(o,t)=>{for(var r in t||(t={}))ht.call(t,r)&&Ue(o,r,t[r]);if(ze)for(var r of ze(t))pt.call(t,r)&&Ue(o,r,t[r]);return o},ee=(o,t)=>ut(o,xt(t));var Ve=(o,t,r)=>Ue(o,typeof t!="symbol"?t+"":t,r);var U=(o,t,r)=>new Promise((c,l)=>{var u=f=>{try{p(r.next(f))}catch(x){l(x)}},d=f=>{try{p(r.throw(f))}catch(x){l(x)}},p=f=>f.done?c(f.value):Promise.resolve(f.value).then(u,d);p((r=r.apply(o,t)).next())});import{a as gt,b as ft,r as s,u as Se,g as bt,d as Qe,R as yt,B as jt,e as Nt,f as Ae,N as vt}from"./vendor-W07s9AD9.js";import{E as wt,_ as Pe}from"./pdf-C06UDWxx.js";import{L as we,X as _e,F as He,C as Ct,a as St,b as kt,c as Tt,A as Xe,U as At,B as Et,d as Le,e as et,S as tt,R as Dt,f as Ge,g as Rt,h as Ot,i as st,j as It,k as Lt,l as Pt,m as Mt,n as $t,E as _t}from"./ui-DWVAqNqj.js";import{r as Ut,R as at,A as Bt,C as Ft,X as Gt,Y as Ht,T as nt,a as Yt,P as Kt,b as zt,c as Vt}from"./charts-DvSD_8Tn.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))c(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function r(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function c(l){if(l.ep)return;l.ep=!0;const u=r(l);fetch(l.href,u)}})();var Be={exports:{}},Oe={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var We;function Wt(){if(We)return Oe;We=1;var o=gt(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,l=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function d(p,f,x){var j,C={},b=null,N=null;x!==void 0&&(b=""+x),f.key!==void 0&&(b=""+f.key),f.ref!==void 0&&(N=f.ref);for(j in f)c.call(f,j)&&!u.hasOwnProperty(j)&&(C[j]=f[j]);if(p&&p.defaultProps)for(j in f=p.defaultProps,f)C[j]===void 0&&(C[j]=f[j]);return{$$typeof:t,type:p,key:b,ref:N,props:C,_owner:l.current}}return Oe.Fragment=r,Oe.jsx=d,Oe.jsxs=d,Oe}var Je;function Jt(){return Je||(Je=1,Be.exports=Wt()),Be.exports}var e=Jt(),Me={},qe;function qt(){if(qe)return Me;qe=1;var o=ft();return Me.createRoot=o.createRoot,Me.hydrateRoot=o.hydrateRoot,Me}var Zt=qt();const Ze=["https://kycsync.com/api","http://kycsync.com/api"],De=()=>Ze[0],$e=De(),rt=s.createContext({user:null,isAuthenticated:!1,login:()=>U(void 0,null,function*(){return!1}),register:()=>U(void 0,null,function*(){return!1}),logout:()=>U(void 0,null,function*(){}),loading:!0}),ke=()=>s.useContext(rt),Qt=({children:o})=>{const[t,r]=s.useState({user:null,isAuthenticated:!1}),[c,l]=s.useState(!0),u=s.useCallback(()=>U(void 0,null,function*(){l(!0);try{const j=yield fetch(`${$e}/auth/user`,{credentials:"include"});if(j.ok){const C=yield j.json();r({user:C.user,isAuthenticated:!0})}else r({user:null,isAuthenticated:!1}),j.status!==401&&console.error("Failed to fetch user:",j.status)}catch(j){console.error("Error fetching user:",j),r({user:null,isAuthenticated:!1})}finally{l(!1)}}),[]);s.useEffect(()=>{u()},[u]);const d=s.useCallback((j,C)=>U(void 0,null,function*(){l(!0);try{const b=yield fetch(`${$e}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:j,password:C}),credentials:"include"});if(b.ok){const N=yield b.json();return r({user:N.user,isAuthenticated:!0}),!0}else{const N=yield b.json();return console.error("Login failed:",N.message),!1}}catch(b){return console.error("Login error:",b),!1}finally{l(!1)}}),[]),p=s.useCallback((j,C,b,N)=>U(void 0,null,function*(){l(!0);try{const I=yield fetch(`${$e}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:j,password:C,name:b,role:N})});if(I.ok)return!0;{const L=yield I.json();return console.error("Registration failed:",L.message),!1}}catch(I){return console.error("Registration error:",I),!1}finally{l(!1)}}),[]),f=s.useCallback(()=>U(void 0,null,function*(){l(!0);try{const j=yield fetch(`${$e}/auth/logout`,{method:"POST",credentials:"include"});j.ok?r({user:null,isAuthenticated:!1}):console.error("Logout failed:",j.status)}catch(j){console.error("Logout error:",j)}finally{l(!1)}}),[]),x={user:t.user,isAuthenticated:t.isAuthenticated,login:d,register:p,logout:f,loading:c};return e.jsx(rt.Provider,{value:x,children:o})},ot=o=>U(void 0,null,function*(){const t=new wt("p","mm","a4"),r=t.internal.pageSize.getWidth();t.setFont("helvetica"),t.setTextColor(85,37,131),t.setFontSize(24),t.text("AML",20,20),t.setTextColor(0,0,0);let c=40;t.setFontSize(14),t.setTextColor(0,0,0),t.text("Customer Information",20,c),c+=10;const l=(x,j)=>{t.setFillColor(240,240,240),t.rect(20,c-4,r-40,7,"F"),t.setFontSize(9),t.setTextColor(100,100,100),t.text(x,22,c),t.setTextColor(0,0,0),t.text(j||"N/A",80,c),c+=7};l("ID",o.id.toString()),l("Full Name",o.name),l("Country of Residence",o.country||"N/A"),l("Nationality",o.country||"N/A");const u=x=>x==="onboarded"?"Onboarded":x.includes("peps")?"PEP":x.includes("terrorists")?"Terrorist":x.includes("sanctions")?"Sanctions":x.includes("debarment")?"Debarred":x;l("Name Screening Hit",o.dataset!=="onboarded"?"YES":"NO"),l("Category",u(o.dataset)),c+=10,t.setFontSize(14),t.text("Key Findings",20,c),c+=10,l("Total Matches","0"),l("Resolved Matches","0"),l("Unresolved Matches","0");const d="This report is generated automatically for AML compliance purposes. This document contains confidential information and should be handled accordingly.";t.setFontSize(8),t.setTextColor(120,120,120);const p=t.splitTextToSize(d,r-60);t.text(p,r/2,280,{align:"center"});const f=`Customer_Report_${o.name.replace(/\s+/g,"_")}.pdf`;t.save(f)}),Xt=({isOpen:o,onConfirm:t,onCancel:r,name:c})=>o?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-xl max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center mb-4 text-amber-600",children:[e.jsx(Xe,{className:"w-6 h-6 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Confirm Tracking"})]}),e.jsxs("p",{className:"mb-4",children:["This action will deduct ",e.jsx("span",{className:"font-bold",children:"1 credit"})," from your account to start tracking ",e.jsx("span",{className:"font-bold",children:c}),"."]}),e.jsx("p",{className:"mb-6 text-sm text-gray-600",children:"Credits are only deducted the first time you track a profile. You can pause and resume tracking at any time without additional charges."}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-100",children:"Cancel"}),e.jsx("button",{onClick:t,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Confirm"})]})]})}):null;function es({searchResults:o=[],isLoading:t=!1,currentPage:r,totalPages:c,totalResults:l,onPageChange:u}){const{user:d}=ke(),p=Se(),f=De(),[x,j]=s.useState({}),[C,b]=s.useState([]),[N,I]=s.useState(t),[L,te]=s.useState(null),[ae,K]=s.useState({}),[E,z]=s.useState(!1),[se,V]=s.useState({isOpen:!1,name:"",currentStatus:!1}),H=s.useCallback(i=>{const w=x[i.name];return w?w.isTracking?w.startDate?`${Math.floor((Date.now()-new Date(w.startDate).getTime())/(1e3*60*60*24))}D`:"0D":w.stopDate&&w.startDate?`<span style="color: red;">${Math.floor((new Date(w.stopDate).getTime()-new Date(w.startDate).getTime())/864e5)}D</span>`:"None":"None"},[x]),q=Array.isArray(o)?o:[],ne=i=>i>=85?"text-red-600":i>=60?"text-yellow-600":"text-green-600",B=i=>{var $,oe;const w=(oe=($=x[i])==null?void 0:$.isTracking)!=null?oe:!1;if(w){W(i);return}if(i in x){W(i);return}V({isOpen:!0,name:i,currentStatus:w})},P=()=>{const{name:i}=se;V(w=>ee(Q({},w),{isOpen:!1})),W(i)},F=()=>{V({isOpen:!1,name:"",currentStatus:!1})},Y=i=>{!u||i<1||i>(c||1)||i===r||(z(!0),window.scrollTo({top:0,behavior:"smooth"}),u(i))};s.useEffect(()=>{E&&z(!1)},[o]);const W=i=>U(this,null,function*(){var w,J;try{const $=(J=(w=x[i])==null?void 0:w.isTracking)!=null?J:!1,oe=yield fetch(`${f}/tracking/${i}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({isTracking:!$}),credentials:"include"});if(!oe.ok){if(oe.status===401){p("/login");return}if(oe.status===402&&(yield oe.json()).needCredits){alert("You do not have enough credits to track this profile. Please purchase more credits."),p("/credits");return}throw new Error("Failed to update tracking")}j(ie=>{var me;return ee(Q({},ie),{[i]:ee(Q({},ie[i]),{isTracking:!$,startDate:$?(me=ie[i])==null?void 0:me.startDate:new Date().toISOString(),stopDate:$?new Date().toISOString():void 0})})})}catch($){console.error("Error updating tracking:",$)}}),X=i=>U(this,null,function*(){try{K(w=>ee(Q({},w),{[i.id]:!0})),yield ot(i),K(w=>ee(Q({},w),{[i.id]:!1}))}catch(w){console.error("Error generating PDF:",w),K(J=>ee(Q({},J),{[i.id]:!1})),alert("Failed to generate PDF. Please try again.")}});return L?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded relative",role:"alert",children:[e.jsx("strong",{className:"font-bold",children:"Error: "}),e.jsx("span",{className:"block sm:inline",children:L})]})}):e.jsxs("div",{className:"p-6",children:[N?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(we,{className:"w-8 h-8 animate-spin text-purple-600"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"overflow-x-auto relative",children:[E&&e.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-70 flex items-center justify-center z-10",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(we,{className:"w-8 h-8 animate-spin text-purple-600"}),e.jsx("p",{className:"mt-2 text-sm text-purple-700 font-medium",children:"Loading results..."})]})}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-sm text-gray-500",children:[e.jsx("th",{className:"pb-4 px-6 whitespace-nowrap",children:"CUSTOMER"}),e.jsx("th",{className:"pb-4 px-6 whitespace-nowrap text-center",children:"FULL NAME"}),e.jsx("th",{className:"pb-4 px-6 whitespace-nowrap text-center",children:"NATIONALITY"}),e.jsx("th",{className:"pb-4 px-6 whitespace-nowrap text-center",children:"AGING"}),e.jsx("th",{className:"pb-4 px-6 whitespace-nowrap text-center",children:"NAME SCREENING"}),e.jsx("th",{className:"pb-4 px-6 whitespace-nowrap text-center",children:"CATEGORY"}),e.jsx("th",{className:"pb-4 px-6 whitespace-nowrap text-center",children:"DOCUMENTATION"}),e.jsx("th",{className:"pb-4 px-6 whitespace-nowrap text-center",children:"RISK RATING"}),e.jsx("th",{className:"pb-4 px-6 whitespace-nowrap text-center",children:"STATUS"}),e.jsx("th",{className:"pb-4 px-6 whitespace-nowrap text-center",children:"TRACKING"})]})}),e.jsxs("tbody",{children:[q.map((i,w)=>{var J,$;return e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:`https://ui-avatars.com/api/?name=${i.name}`,alt:i.name,className:"w-8 h-8 rounded-full"}),e.jsx("span",{className:"text-sm",children:i.identifiers})]})}),e.jsx("td",{className:"py-4 px-6 text-sm text-center",children:i.name}),e.jsx("td",{className:"py-4 px-6 text-sm text-center",children:i.country&&i.country!=="Unknown"&&i.country!=="N/A"?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("img",{src:`https://flagcdn.com/w20/${i.country.toLowerCase()}.png`,alt:i.country,className:"mr-2 h-3 rounded shadow-sm",title:i.country}),i.country]}):"-"}),e.jsx("td",{className:"py-4 px-6 text-sm text-center",dangerouslySetInnerHTML:{__html:H(i)}}),e.jsx("td",{className:"py-4 px-6 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-6 h-6 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(_e,{className:"w-4 h-4 text-red-500"})})})}),e.jsx("td",{className:"py-4 px-6 text-center",children:i.dataset?e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${i.dataset==="onboarded"?"bg-green-100 text-green-700":i.dataset.includes("peps")?"bg-yellow-100 text-yellow-700":i.dataset.includes("terrorists")?"bg-red-100 text-red-700":i.dataset.includes("sanctions")?"bg-orange-100 text-orange-700":i.dataset.includes("debarment")?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:i.dataset==="onboarded"?"Onboarded":i.dataset.includes("peps")?"PEP":i.dataset.includes("terrorists")?"Terrorist":i.dataset.includes("sanctions")?"Sanctions":i.dataset.includes("debarment")?"Debarred":i.dataset}):e.jsx("span",{children:"-"})}),e.jsx("td",{className:"py-4 px-6 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:()=>X(i),disabled:ae[i.id],className:"flex items-center justify-center bg-blue-50 hover:bg-blue-100 text-blue-700 p-2 rounded-full transition-colors duration-200",title:"Download Report",children:ae[i.id]?e.jsx(we,{className:"w-4 h-4 animate-spin"}):e.jsx(He,{className:"w-4 h-4"})})})}),e.jsx("td",{className:"py-4 px-6 text-center",children:e.jsxs("span",{className:`text-sm ${ne(i.riskLevel)}`,children:[i.riskLevel,"%"]})}),e.jsx("td",{className:"py-4 px-6 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-yellow-100 text-yellow-800",children:"Review"})})}),e.jsx("td",{className:"py-4 px-6 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:()=>B(i.name),className:`w-8 h-5 rounded-full flex items-center transition-colors duration-300 focus:outline-none ${(J=x[i.name])!=null&&J.isTracking?"bg-purple-500":"bg-gray-300"}`,children:e.jsx("div",{className:`w-3 h-3 rounded-full bg-white shadow-md transform transition-transform duration-300 ${($=x[i.name])!=null&&$.isTracking?"translate-x-4":"translate-x-1"}`})})})})]},`search-${w}`)}),q.length===0&&!N&&e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"py-4 px-6 text-center text-gray-500",children:"No results found"})})]})]})]}),c&&c>1&&u&&e.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing page ",r," of ",c," (",l," total results)"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>Y(1),disabled:r===1||E,className:`p-2 rounded-md ${r===1||E?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-purple-100 text-purple-700 hover:bg-purple-200"}`,"aria-label":"First page",children:e.jsx(Ct,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Y(r-1),disabled:r===1||E,className:`p-2 rounded-md ${r===1||E?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-purple-100 text-purple-700 hover:bg-purple-200"}`,"aria-label":"Previous page",children:e.jsx(St,{className:"w-4 h-4"})}),e.jsx("div",{className:"flex items-center px-2",children:e.jsx("select",{value:r,onChange:i=>Y(Number(i.target.value)),disabled:E,className:"px-2 py-1 border border-gray-300 rounded text-sm bg-white",children:Array.from({length:c},(i,w)=>w+1).map(i=>e.jsx("option",{value:i,children:i},i))})}),e.jsx("button",{onClick:()=>Y(r+1),disabled:r===c||E,className:`p-2 rounded-md ${r===c||E?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-purple-100 text-purple-700 hover:bg-purple-200"}`,"aria-label":"Next page",children:e.jsx(kt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Y(c),disabled:r===c||E,className:`p-2 rounded-md ${r===c||E?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-purple-100 text-purple-700 hover:bg-purple-200"}`,"aria-label":"Last page",children:e.jsx(Tt,{className:"w-4 h-4"})}),E&&e.jsx("span",{className:"ml-2",children:e.jsx(we,{className:"w-4 h-4 animate-spin text-purple-600"})})]})]})]}),e.jsx(Xt,{isOpen:se.isOpen,onConfirm:P,onCancel:F,name:se.name})]})}var ts=Ut();const ss=bt(ts),as=[{code:"AF",name:"Afghanistan"},{code:"AL",name:"Albania"},{code:"DZ",name:"Algeria"},{code:"AD",name:"Andorra"},{code:"AO",name:"Angola"},{code:"AG",name:"Antigua and Barbuda"},{code:"AR",name:"Argentina"},{code:"AM",name:"Armenia"},{code:"AU",name:"Australia"},{code:"AT",name:"Austria"},{code:"AZ",name:"Azerbaijan"},{code:"BS",name:"Bahamas"},{code:"BH",name:"Bahrain"},{code:"BD",name:"Bangladesh"},{code:"BB",name:"Barbados"},{code:"BY",name:"Belarus"},{code:"BE",name:"Belgium"},{code:"BZ",name:"Belize"},{code:"BJ",name:"Benin"},{code:"BT",name:"Bhutan"},{code:"BO",name:"Bolivia"},{code:"BA",name:"Bosnia and Herzegovina"},{code:"BW",name:"Botswana"},{code:"BR",name:"Brazil"},{code:"BN",name:"Brunei"},{code:"BG",name:"Bulgaria"},{code:"BF",name:"Burkina Faso"},{code:"BI",name:"Burundi"},{code:"CV",name:"Cabo Verde"},{code:"KH",name:"Cambodia"},{code:"CM",name:"Cameroon"},{code:"CA",name:"Canada"},{code:"CF",name:"Central African Republic"},{code:"TD",name:"Chad"},{code:"CL",name:"Chile"},{code:"CN",name:"China"},{code:"CO",name:"Colombia"},{code:"KM",name:"Comoros"},{code:"CG",name:"Congo"},{code:"CD",name:"Congo (Democratic Republic)"},{code:"CR",name:"Costa Rica"},{code:"CI",name:"Côte d'Ivoire"},{code:"HR",name:"Croatia"},{code:"CU",name:"Cuba"},{code:"CY",name:"Cyprus"},{code:"CZ",name:"Czech Republic"},{code:"DK",name:"Denmark"},{code:"DJ",name:"Djibouti"},{code:"DM",name:"Dominica"},{code:"DO",name:"Dominican Republic"},{code:"EC",name:"Ecuador"},{code:"EG",name:"Egypt"},{code:"SV",name:"El Salvador"},{code:"GQ",name:"Equatorial Guinea"},{code:"ER",name:"Eritrea"},{code:"EE",name:"Estonia"},{code:"SZ",name:"Eswatini"},{code:"ET",name:"Ethiopia"},{code:"FJ",name:"Fiji"},{code:"FI",name:"Finland"},{code:"FR",name:"France"},{code:"GA",name:"Gabon"},{code:"GM",name:"Gambia"},{code:"GE",name:"Georgia"},{code:"DE",name:"Germany"},{code:"GH",name:"Ghana"},{code:"GR",name:"Greece"},{code:"GD",name:"Grenada"},{code:"GT",name:"Guatemala"},{code:"GN",name:"Guinea"},{code:"GW",name:"Guinea-Bissau"},{code:"GY",name:"Guyana"},{code:"HT",name:"Haiti"},{code:"HN",name:"Honduras"},{code:"HU",name:"Hungary"},{code:"IS",name:"Iceland"},{code:"IN",name:"India"},{code:"ID",name:"Indonesia"},{code:"IR",name:"Iran"},{code:"IQ",name:"Iraq"},{code:"IE",name:"Ireland"},{code:"IL",name:"Israel"},{code:"IT",name:"Italy"},{code:"JM",name:"Jamaica"},{code:"JP",name:"Japan"},{code:"JO",name:"Jordan"},{code:"KZ",name:"Kazakhstan"},{code:"KE",name:"Kenya"},{code:"KI",name:"Kiribati"},{code:"KP",name:"Korea, North"},{code:"KR",name:"Korea, South"},{code:"KW",name:"Kuwait"},{code:"KG",name:"Kyrgyzstan"},{code:"LA",name:"Laos"},{code:"LV",name:"Latvia"},{code:"LB",name:"Lebanon"},{code:"LS",name:"Lesotho"},{code:"LR",name:"Liberia"},{code:"LY",name:"Libya"},{code:"LI",name:"Liechtenstein"},{code:"LT",name:"Lithuania"},{code:"LU",name:"Luxembourg"},{code:"MG",name:"Madagascar"},{code:"MW",name:"Malawi"},{code:"MY",name:"Malaysia"},{code:"MV",name:"Maldives"},{code:"ML",name:"Mali"},{code:"MT",name:"Malta"},{code:"MH",name:"Marshall Islands"},{code:"MR",name:"Mauritania"},{code:"MU",name:"Mauritius"},{code:"MX",name:"Mexico"},{code:"FM",name:"Micronesia"},{code:"MD",name:"Moldova"},{code:"MC",name:"Monaco"},{code:"MN",name:"Mongolia"},{code:"ME",name:"Montenegro"},{code:"MA",name:"Morocco"},{code:"MZ",name:"Mozambique"},{code:"MM",name:"Myanmar"},{code:"NA",name:"Namibia"},{code:"NR",name:"Nauru"},{code:"NP",name:"Nepal"},{code:"NL",name:"Netherlands"},{code:"NZ",name:"New Zealand"},{code:"NI",name:"Nicaragua"},{code:"NE",name:"Niger"},{code:"NG",name:"Nigeria"},{code:"MK",name:"North Macedonia"},{code:"NO",name:"Norway"},{code:"OM",name:"Oman"},{code:"PK",name:"Pakistan"},{code:"PW",name:"Palau"},{code:"PS",name:"Palestine"},{code:"PA",name:"Panama"},{code:"PG",name:"Papua New Guinea"},{code:"PY",name:"Paraguay"},{code:"PE",name:"Peru"},{code:"PH",name:"Philippines"},{code:"PL",name:"Poland"},{code:"PT",name:"Portugal"},{code:"QA",name:"Qatar"},{code:"RO",name:"Romania"},{code:"RU",name:"Russia"},{code:"RW",name:"Rwanda"},{code:"KN",name:"Saint Kitts and Nevis"},{code:"LC",name:"Saint Lucia"},{code:"VC",name:"Saint Vincent and the Grenadines"},{code:"WS",name:"Samoa"},{code:"SM",name:"San Marino"},{code:"ST",name:"Sao Tome and Principe"},{code:"SA",name:"Saudi Arabia"},{code:"SN",name:"Senegal"},{code:"RS",name:"Serbia"},{code:"SC",name:"Seychelles"},{code:"SL",name:"Sierra Leone"},{code:"SG",name:"Singapore"},{code:"SK",name:"Slovakia"},{code:"SI",name:"Slovenia"},{code:"SB",name:"Solomon Islands"},{code:"SO",name:"Somalia"},{code:"ZA",name:"South Africa"},{code:"SS",name:"South Sudan"},{code:"ES",name:"Spain"},{code:"LK",name:"Sri Lanka"},{code:"SD",name:"Sudan"},{code:"SR",name:"Suriname"},{code:"SE",name:"Sweden"},{code:"CH",name:"Switzerland"},{code:"SY",name:"Syria"},{code:"TW",name:"Taiwan"},{code:"TJ",name:"Tajikistan"},{code:"TZ",name:"Tanzania"},{code:"TH",name:"Thailand"},{code:"TL",name:"Timor-Leste"},{code:"TG",name:"Togo"},{code:"TO",name:"Tonga"},{code:"TT",name:"Trinidad and Tobago"},{code:"TN",name:"Tunisia"},{code:"TR",name:"Turkey"},{code:"TM",name:"Turkmenistan"},{code:"TV",name:"Tuvalu"},{code:"UG",name:"Uganda"},{code:"UA",name:"Ukraine"},{code:"AE",name:"United Arab Emirates"},{code:"GB",name:"United Kingdom"},{code:"US",name:"United States"},{code:"UY",name:"Uruguay"},{code:"UZ",name:"Uzbekistan"},{code:"VU",name:"Vanuatu"},{code:"VA",name:"Vatican City"},{code:"VE",name:"Venezuela"},{code:"VN",name:"Vietnam"},{code:"YE",name:"Yemen"},{code:"ZM",name:"Zambia"},{code:"ZW",name:"Zimbabwe"}],it={US:["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],CA:["Alberta","British Columbia","Manitoba","New Brunswick","Newfoundland and Labrador","Northwest Territories","Nova Scotia","Nunavut","Ontario","Prince Edward Island","Quebec","Saskatchewan","Yukon"],GB:["England","Northern Ireland","Scotland","Wales"],AU:["Australian Capital Territory","New South Wales","Northern Territory","Queensland","South Australia","Tasmania","Victoria","Western Australia"],IN:["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal"],CN:["Anhui","Beijing","Chongqing","Fujian","Gansu","Guangdong","Guangxi","Guizhou","Hainan","Hebei","Heilongjiang","Henan","Hubei","Hunan","Inner Mongolia","Jiangsu","Jiangxi","Jilin","Liaoning","Ningxia","Qinghai","Shaanxi","Shandong","Shanghai","Shanxi","Sichuan","Tianjin","Tibet","Xinjiang","Yunnan","Zhejiang"]},lt=()=>[...as].sort((o,t)=>o.name.localeCompare(t.name));function ns(){const o=De();Se();const[t,r]=s.useState(""),[c,l]=s.useState(""),[u,d]=s.useState(""),[p,f]=s.useState(""),[x,j]=s.useState(""),[C,b]=s.useState(""),[N,I]=s.useState(""),[L,te]=s.useState(!1),[ae,K]=s.useState(""),[E,z]=s.useState(""),[se,V]=s.useState(""),[H,q]=s.useState(""),[ne,B]=s.useState(""),[P,F]=s.useState(""),[Y,W]=s.useState(""),[X,i]=s.useState(""),[w,J]=s.useState(""),[$,oe]=s.useState(""),[ie,me]=s.useState(""),[xe,de]=s.useState(""),[he,ye]=s.useState(""),[pe,a]=s.useState(""),[g,T]=s.useState(""),[v,y]=s.useState(""),[G,le]=s.useState(""),Z=lt(),ue=N?it[N]||[]:[],{user:fe}=ke(),D=m=>U(this,null,function*(){if(m.preventDefault(),!t||!c){alert("Full Name and Email are required.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c)){alert("Invalid email format.");return}const be=ge=>ge?new Date(ge).toISOString().split("T")[0]:null,Re={fullName:t,email:c,residentStatus:u,gender:p,dateOfBirth:be(x),nationality:C,countryOfResidence:N,otherNationalities:L,specifiedOtherNationalities:ae,nationalIdNumber:E,nationalIdExpiry:be(se),passportNumber:H,passportExpiry:be(ne),address:P,state:Y,city:X,zipCode:w,contactNumber:$,dialingCode:ie,workType:xe,industry:he,productTypeOffered:pe,productOffered:g,companyName:v,positionInCompany:G};try{const ge=yield fetch(`${o}/registerIndividual`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Re),credentials:"include"}),je=yield ge.json();if(ge.ok){alert("Individual registration successful! Redirecting to Active Tracking."),r(""),l(""),d(""),f(""),j(""),b(""),I(""),te(!1),K(""),z(""),V(""),q(""),B(""),F(""),W(""),i(""),J(""),oe(""),me(""),de(""),ye(""),a(""),T(""),y(""),le("");const n=new URLSearchParams({section:"activeTracking",refresh:"true",t:Date.now().toString()});window.location.href=`/mainapp?${n.toString()}`}else alert(je.message||"Registration failed")}catch(ge){console.error("Error submitting form:",ge),alert("An error occurred during submission. Please try again.")}});return e.jsxs("div",{className:"p-8 bg-gray-50",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Register Individual Profile"}),e.jsx("p",{className:"mb-8 text-gray-600",children:"Complete the form below to register individual profile."}),e.jsxs("form",{onSubmit:D,className:"grid grid-cols-1 md:grid-cols-3 gap-6 bg-white p-6 rounded-2xl shadow-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"FULL NAME"}),e.jsx("input",{type:"text",value:t,onChange:m=>r(m.target.value),placeholder:"Enter full name",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"EMAIL"}),e.jsx("input",{type:"email",value:c,onChange:m=>l(m.target.value),placeholder:"Enter email",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"RESIDENT STATUS"}),e.jsxs("select",{value:u,onChange:m=>d(m.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select Resident Status"}),e.jsx("option",{value:"citizen",children:"Citizen"}),e.jsx("option",{value:"resident",children:"Resident"}),e.jsx("option",{value:"non-resident",children:"Non-Resident"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"GENDER"}),e.jsxs("select",{value:p,onChange:m=>f(m.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"DATE OF BIRTH"}),e.jsx("input",{type:"date",value:x,onChange:m=>j(m.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"NATIONALITY"}),e.jsxs("select",{value:C,onChange:m=>b(m.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select Nationality"}),Z.map(m=>e.jsx("option",{value:m.code,children:m.name},`nat-${m.code}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"COUNTRY OF RESIDENCE"}),e.jsxs("select",{value:N,onChange:m=>I(m.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select Country of Residence"}),Z.map(m=>e.jsx("option",{value:m.code,children:m.name},`res-${m.code}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"DO YOU HAVE OTHER NATIONALITIES?"}),e.jsxs("div",{className:"mt-1 flex space-x-4",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"yes",checked:L===!0,onChange:()=>te(!0),className:"form-radio h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"}),e.jsx("span",{className:"ml-2",children:"Yes"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"no",checked:L===!1,onChange:()=>te(!1),className:"form-radio h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"}),e.jsx("span",{className:"ml-2",children:"No"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"SPECIFY OTHER NATIONALITIES (IF APPLICABLE)"}),e.jsxs("select",{value:ae,onChange:m=>K(m.target.value),disabled:!L,className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"",children:"Select Other Nationalities"}),Z.map(m=>e.jsx("option",{value:m.code,children:m.name},`other-${m.code}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"NATIONAL ID NUMBER"}),e.jsx("input",{type:"text",value:E,onChange:m=>z(m.target.value),placeholder:"Enter National ID Number",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"NATIONAL ID EXPIRY"}),e.jsx("input",{type:"date",value:se,onChange:m=>V(m.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"PASSPORT NUMBER"}),e.jsx("input",{type:"text",value:H,onChange:m=>q(m.target.value),placeholder:"Enter Passport Number",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"PASSPORT EXPIRY"}),e.jsx("input",{type:"date",value:ne,onChange:m=>B(m.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsx("div",{className:"md:col-span-3 mt-6",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Contact Information"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"ADDRESS"}),e.jsx("input",{type:"text",value:P,onChange:m=>F(m.target.value),placeholder:"Enter address",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"STATE"}),e.jsxs("select",{value:Y,onChange:m=>W(m.target.value),disabled:!N||ue.length===0,className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"",children:"Select State"}),ue.map(m=>e.jsx("option",{value:m,children:m},m))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"CITY"}),e.jsx("input",{type:"text",value:X,onChange:m=>i(m.target.value),placeholder:"Enter city",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"ZIP CODE/POSTAL CODE"}),e.jsx("input",{type:"text",value:w,onChange:m=>J(m.target.value),placeholder:"Enter zip code",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"DIALING CODE"}),e.jsx("input",{type:"text",value:ie,onChange:m=>me(m.target.value),placeholder:"e.g., +1",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"CONTACT NUMBER"}),e.jsx("input",{type:"tel",value:$,onChange:m=>oe(m.target.value),placeholder:"Enter phone number",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsx("div",{className:"md:col-span-3 mt-6",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Profile Information"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"WORK TYPE"}),e.jsxs("select",{value:xe,onChange:m=>de(m.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select Work Type"}),e.jsx("option",{value:"employee",children:"Employee"}),e.jsx("option",{value:"contractor",children:"Contractor"}),e.jsx("option",{value:"freelancer",children:"Freelancer"}),e.jsx("option",{value:"business_owner",children:"Business Owner"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"INDUSTRY"}),e.jsxs("select",{value:he,onChange:m=>ye(m.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select Industry"}),e.jsx("option",{value:"finance",children:"Finance"}),e.jsx("option",{value:"technology",children:"Technology"}),e.jsx("option",{value:"healthcare",children:"Healthcare"}),e.jsx("option",{value:"education",children:"Education"}),e.jsx("option",{value:"retail",children:"Retail"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"PRODUCT TYPE OFFERED TO CUSTOMER"}),e.jsxs("select",{value:pe,onChange:m=>a(m.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select Product Type"}),e.jsx("option",{value:"goods",children:"Physical Goods"}),e.jsx("option",{value:"services",children:"Services"}),e.jsx("option",{value:"digital",children:"Digital Products"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"PRODUCT OFFERED"}),e.jsx("input",{type:"text",value:g,onChange:m=>T(m.target.value),placeholder:"Enter Product Offered",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"COMPANY NAME"}),e.jsx("input",{type:"text",value:v,onChange:m=>y(m.target.value),placeholder:"Enter Company Name",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"POSITION IN COMPANY"}),e.jsx("input",{type:"text",value:G,onChange:m=>le(m.target.value),placeholder:"Enter Position in Company",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsx("div",{className:"md:col-span-3",children:e.jsx("button",{type:"submit",className:"mt-4 px-6 py-2 bg-[#4A1D96] text-white rounded-lg hover:bg-[#3c177d] focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50",children:"REGISTER"})})]})]})}function rs(){Se();const o=De(),[t,r]=s.useState({companyName:"",registrationNumber:"",companyType:"",incorporationDate:"",businessNature:"",industrySector:"",annualTurnover:"",employeeCount:"",websiteUrl:"",registeredAddress:"",operatingAddress:"",country:"",state:"",city:"",postalCode:"",contactPersonName:"",contactEmail:"",contactPhone:"",taxNumber:"",regulatoryLicenses:""}),[c,l]=s.useState(!1),[u,d]=s.useState(null),p=b=>{const{name:N,value:I}=b.target;r(L=>ee(Q({},L),{[N]:I})),N==="country"&&r(L=>ee(Q({},L),{state:""}))},f=b=>{if(!b)return null;try{const N=new Date(b);return isNaN(N.getTime())?(console.warn("Invalid date string:",b),null):N.toISOString().split("T")[0]}catch(N){return console.error("Date formatting error",N),null}},x=b=>U(this,null,function*(){b.preventDefault(),l(!0),d(null);const N=ee(Q({},t),{incorporationDate:f(t.incorporationDate)});try{const I=yield fetch(`${o}/registerCompany`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(N)}),L=yield I.json();if(!I.ok)throw new Error(L.message||"Something went wrong");alert("Company registration successful! Redirecting to Active Tracking.");const te=new URLSearchParams({section:"activeTracking",refresh:"true",t:Date.now().toString()});window.location.href=`/mainapp?${te.toString()}`}catch(I){I instanceof Error?d(I.message||"An unexpected error occurred"):d("An unexpected error occurred")}finally{l(!1)}}),j=lt(),C=t.country?it[t.country]||[]:[];return e.jsxs("div",{className:"p-8 bg-gray-50",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Register Company Profile"}),e.jsx("p",{className:"mb-8 text-gray-600",children:"Complete the form below to register your company profile."}),e.jsxs("form",{onSubmit:x,className:"grid grid-cols-1 md:grid-cols-2 gap-6 bg-white p-6 rounded-2xl shadow-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"COMPANY NAME"}),e.jsx("input",{type:"text",name:"companyName",value:t.companyName,onChange:p,placeholder:"Enter company name",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"REGISTRATION NUMBER"}),e.jsx("input",{type:"text",name:"registrationNumber",value:t.registrationNumber,onChange:p,placeholder:"Enter registration number",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"COMPANY TYPE"}),e.jsxs("select",{name:"companyType",value:t.companyType,onChange:p,className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select company type"}),e.jsx("option",{value:"llc",children:"LLC"}),e.jsx("option",{value:"corporation",children:"Corporation"}),e.jsx("option",{value:"partnership",children:"Partnership"}),e.jsx("option",{value:"sole_proprietorship",children:"Sole Proprietorship"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"INCORPORATION DATE"}),e.jsx("input",{type:"date",name:"incorporationDate",value:t.incorporationDate,onChange:p,className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"BUSINESS NATURE"}),e.jsx("input",{type:"text",name:"businessNature",value:t.businessNature,onChange:p,placeholder:"Enter nature of business",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"INDUSTRY SECTOR"}),e.jsxs("select",{name:"industrySector",value:t.industrySector,onChange:p,className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select industry sector"}),e.jsx("option",{value:"technology",children:"Technology"}),e.jsx("option",{value:"finance",children:"Finance"}),e.jsx("option",{value:"healthcare",children:"Healthcare"}),e.jsx("option",{value:"retail",children:"Retail"}),e.jsx("option",{value:"manufacturing",children:"Manufacturing"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"ANNUAL TURNOVER"}),e.jsx("input",{type:"number",name:"annualTurnover",value:t.annualTurnover,onChange:p,placeholder:"Enter annual turnover",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"NUMBER OF EMPLOYEES"}),e.jsx("input",{type:"number",name:"employeeCount",value:t.employeeCount,onChange:p,placeholder:"Enter number of employees",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"WEBSITE URL"}),e.jsx("input",{type:"url",name:"websiteUrl",value:t.websiteUrl,onChange:p,placeholder:"Enter website URL",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"REGISTERED ADDRESS"}),e.jsx("input",{type:"text",name:"registeredAddress",value:t.registeredAddress,onChange:p,placeholder:"Enter registered address",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"OPERATING ADDRESS"}),e.jsx("input",{type:"text",name:"operatingAddress",value:t.operatingAddress,onChange:p,placeholder:"Enter operating address",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"COUNTRY"}),e.jsxs("select",{name:"country",value:t.country,onChange:p,className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select Country"}),j.map(b=>e.jsx("option",{value:b.code,children:b.name},b.code))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"STATE"}),e.jsxs("select",{name:"state",value:t.state,onChange:p,disabled:!t.country||C.length===0,className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"",children:"Select State"}),C.map(b=>e.jsx("option",{value:b,children:b},b))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"CITY"}),e.jsx("input",{type:"text",name:"city",value:t.city,onChange:p,placeholder:"Enter city",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"POSTAL CODE"}),e.jsx("input",{type:"text",name:"postalCode",value:t.postalCode,onChange:p,placeholder:"Enter postal code",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"CONTACT PERSON NAME"}),e.jsx("input",{type:"text",name:"contactPersonName",value:t.contactPersonName,onChange:p,placeholder:"Enter contact person name",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"CONTACT EMAIL"}),e.jsx("input",{type:"email",name:"contactEmail",value:t.contactEmail,onChange:p,placeholder:"Enter contact email",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"CONTACT PHONE"}),e.jsx("input",{type:"tel",name:"contactPhone",value:t.contactPhone,onChange:p,placeholder:"Enter contact phone",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"TAX NUMBER"}),e.jsx("input",{type:"text",name:"taxNumber",value:t.taxNumber,onChange:p,placeholder:"Enter tax number",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"REGULATORY LICENSES"}),e.jsx("textarea",{name:"regulatoryLicenses",value:t.regulatoryLicenses,onChange:p,placeholder:"Enter regulatory licenses",rows:3,className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("button",{type:"submit",disabled:c,className:"mt-4 px-6 py-2 bg-[#4A1D96] text-white rounded-lg hover:bg-[#3c177d] focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50 disabled:opacity-50",children:c?"Submitting...":"REGISTER"}),u&&e.jsx("p",{className:"mt-2 text-red-500",children:u})]})]})]})}const os=({customers:o,status:t,onViewCustomer:r})=>{const c=d=>{if(!d)return"N/A";try{return new Date(d).toLocaleDateString()}catch(p){return"Invalid Date"}},l=d=>{const p=d.createdAt||d.created_at||d.registrationDate||d.registration_date||d.onboardingDate||d.onboarding_date||d.date;return c(p)},u=d=>d.type==="individual"?d.full_name||d.name||"Individual Customer":d.companyName||d.company_name||d.name||"Company";return o.length===0?e.jsx("div",{className:"p-4 text-gray-500 text-center italic",children:"No customers found in this category."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),t===null&&e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(d=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.type==="individual"?e.jsxs("div",{className:"flex items-center",children:[e.jsx(At,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsx("span",{children:"Individual"})]}):e.jsxs("div",{className:"flex items-center",children:[e.jsx(Et,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsx("span",{children:"Company"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:u(d)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:d.email||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:l(d)})}),t===null&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full 
                                        ${d.status==="approved"?"bg-green-100 text-green-800":d.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:d.status.charAt(0).toUpperCase()+d.status.slice(1)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("button",{className:"text-indigo-600 hover:text-indigo-900 flex items-center justify-end",onClick:()=>r(d),children:[e.jsx("span",{children:"View"}),e.jsx(Le,{className:"h-4 w-4 ml-1"})]})})]},`${d.type}-${d.id}`))})]})})},is=({customer:o,onBack:t})=>{const r=u=>{if(!u)return"N/A";try{return new Date(u).toLocaleDateString()}catch(d){return"Invalid Date"}},c=u=>{const d=u.createdAt||u.created_at||u.registrationDate||u.registration_date||u.onboardingDate||u.onboarding_date||u.date;return r(d)},l=u=>u.type==="individual"?u.full_name||u.name||"Individual Customer":u.companyName||u.company_name||u.name||"Company";return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-center mb-6",children:e.jsxs("button",{onClick:t,className:"flex items-center text-gray-600 hover:text-gray-900",children:[e.jsx(et,{className:"h-5 w-5 mr-2"}),e.jsx("span",{children:"Back to List"})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:o.type==="individual"?"Individual Details":"Company Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.type==="individual"?e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Full Name"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:l(o)})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Company Name"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:l(o)})]})}),o.email&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Email"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:o.email})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Status"}),e.jsx("span",{className:`mt-1 px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full 
                            ${o.status==="approved"?"bg-green-100 text-green-800":o.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:o.status.charAt(0).toUpperCase()+o.status.slice(1)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Date Registered"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:c(o)})]}),Object.entries(o).map(([u,d])=>{if(["id","type","fullName","companyName","name","full_name","email","status","createdAt","updatedAt"].includes(u)||d==null||typeof d=="object")return null;const p=u.replace(/([A-Z])/g," $1").replace(/^./,f=>f.toUpperCase()).replace(/_/g," ");return e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:p}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:d.toString()})]},u)})]})]})]})},ls=({data:o})=>e.jsx("div",{className:"w-full h-[200px]",children:e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(Bt,{data:o,margin:{top:10,right:10,left:0,bottom:0},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorCount",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#4A1D96",stopOpacity:.1}),e.jsx("stop",{offset:"95%",stopColor:"#4A1D96",stopOpacity:0})]})}),e.jsx(Ft,{strokeDasharray:"3 3",vertical:!1}),e.jsx(Gt,{dataKey:"date",tick:{fontSize:12},tickLine:!1,axisLine:!1}),e.jsx(Ht,{tick:{fontSize:12},tickLine:!1,axisLine:!1,tickFormatter:t=>Math.floor(t)}),e.jsx(nt,{contentStyle:{backgroundColor:"white",border:"none",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},formatter:t=>[Math.floor(t),"Customers"],labelFormatter:t=>`Date: ${t}`}),e.jsx(Yt,{type:"monotone",dataKey:"count",stroke:"#4A1D96",strokeWidth:2,fill:"url(#colorCount)",dot:{fill:"#4A1D96",r:4},activeDot:{r:6,fill:"#4A1D96"}})]})})}),cs=({data:o,title:t,centerText:r})=>(o.reduce((c,l)=>c+l.value,0),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-base font-medium text-gray-900 mb-4",children:t}),e.jsxs("div",{className:"w-full h-[300px] relative",children:[e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(Kt,{children:[e.jsx(zt,{data:o,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:0,dataKey:"value",children:o.map((c,l)=>e.jsx(Vt,{fill:c.color},`cell-${l}`))}),e.jsx(nt,{contentStyle:{backgroundColor:"white",border:"none",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},formatter:(c,l)=>[c,l]})]})}),r&&e.jsxs("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center",children:[e.jsx("p",{className:"text-sm text-gray-500",children:r.label}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:r.value})]})]}),e.jsx("div",{className:"mt-4 space-y-2",children:o.map((c,l)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:c.color}}),e.jsx("span",{className:"text-sm text-gray-600",children:c.name})]}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:c.value})]},l))})]}));function ds(o){const[t,r]=s.useState(!1),[c,l]=s.useState(!1),[u,d]=s.useState(""),[p,f]=s.useState(""),[x,j]=s.useState(0),[C,b]=s.useState(0),[N,I]=s.useState(0),[L,te]=s.useState(0),[ae,K]=s.useState([]),[E,z]=s.useState([]),[se,V]=s.useState("dashboard"),[H,q]=s.useState(null),[ne,B]=s.useState(null),[P,F]=s.useState([]),[Y,W]=s.useState([]),X=s.useRef(null),i=s.useRef(null),{user:w}=ke(),J=Se(),$=De();s.useEffect(()=>{const a=g=>{X.current&&!X.current.contains(g.target)&&r(!1),i.current&&!i.current.contains(g.target)&&l(!1)};return document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[]);const oe=a=>{const g=new Map;a.forEach(v=>{const y=v.createdAt||v.created_at||v.registrationDate||v.registration_date||v.onboardingDate||v.onboarding_date||v.date;if(y){const G=new Date(y).toLocaleDateString("en-US",{month:"short",day:"numeric"});g.set(G,(g.get(G)||0)+1)}});const T=Array.from(g.entries()).map(([v,y])=>({date:v,count:y})).sort((v,y)=>new Date(v.date).getTime()-new Date(y.date).getTime());F(T)},ie=()=>U(this,null,function*(){if(!w){J("/login");return}try{const a=yield fetch(`${$}/individualob`,{method:"GET",credentials:"include"});if(!a.ok){if(a.status===401){J("/login");return}throw new Error(`HTTP error: ${a.status}`)}const g=yield a.json();K(g.map(D=>ee(Q({},D),{type:"individual",fullName:D.fullName||D.name||D.full_name||`${D.firstName||""} ${D.lastName||""}`.trim()||"Unknown"})));const T=yield fetch(`${$}/companyob`,{method:"GET",credentials:"include"});if(!T.ok){if(T.status===401){J("/login");return}throw new Error(`HTTP error: ${T.status}`)}const v=yield T.json();z(v.map(D=>ee(Q({},D),{type:"company",companyName:D.companyName||D.company_name||D.name||"Unknown Company"})));const y=[...g,...v];j(y.length);let G=0,le=0,Z=0;y.forEach(D=>{D.status==="pending"?G++:D.status==="approved"?le++:D.status==="rejected"&&Z++}),b(G),I(le),te(Z),oe(y);let ue=0,fe=0;y.forEach(D=>{var Ce,be;D.hasMatch||D.has_match||D.alertStatus==="triggered"||D.alert_status==="triggered"||((Ce=D.matches)==null?void 0:Ce.length)>0||((be=D.alerts)==null?void 0:be.length)>0?ue++:fe++}),W([{name:"Onboarding Without Alert",value:fe,color:"#9333EA"},{name:"Onboarding With Alert",value:ue,color:"#22D3EE"}])}catch(a){console.error("Error fetching data:",a.message)}});s.useEffect(()=>{ie()},[w,J]);const me=[...ae,...E],xe=a=>a===null?me:me.filter(g=>g.status===a),de=a=>{q(a),V("list")},he=a=>{B(a),V("details")},ye=()=>{se==="details"?(V("list"),B(null)):se==="list"&&(V("dashboard"),q(null))},pe=()=>e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Activity Dashboard"}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"from-date",className:"block text-sm font-medium text-gray-700",children:"From"}),e.jsx("div",{className:"relative mt-1",children:e.jsx("input",{type:"date",id:"from-date",value:u,onChange:a=>d(a.target.value),className:"w-full px-4 py-2 text-sm border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-purple-500"})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"to-date",className:"block text-sm font-medium text-gray-700",children:"To"}),e.jsx("div",{className:"relative mt-1",children:e.jsx("input",{type:"date",id:"to-date",value:p,onChange:a=>f(a.target.value),className:"w-full px-4 py-2 text-sm border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-purple-500"})})]}),e.jsx("button",{className:"px-6 py-2 bg-[#4A1D96] text-white rounded-lg text-sm h-10 mt-6",children:"APPLY"}),e.jsx("button",{className:"px-6 py-2 bg-[#FFC727] text-black rounded-lg text-sm h-10 mt-6",children:"EXPORT"})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6 cursor-pointer hover:bg-purple-50 transition-colors",onClick:()=>de(null),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium text-gray-900",children:"CUSTOMER ONBOARDED"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:x})]}),e.jsx(Le,{className:"h-5 w-5 text-gray-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 cursor-pointer hover:bg-purple-50 transition-colors",onClick:()=>de("pending"),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium text-gray-900",children:"PENDING CUSTOMERS"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:C})]}),e.jsx(Le,{className:"h-5 w-5 text-gray-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 cursor-pointer hover:bg-purple-50 transition-colors",onClick:()=>de("approved"),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium text-gray-900",children:"APPROVED CUSTOMERS"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:N})]}),e.jsx(Le,{className:"h-5 w-5 text-gray-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 cursor-pointer hover:bg-purple-50 transition-colors",onClick:()=>de("rejected"),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium text-gray-900",children:"REJECTED CUSTOMERS"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:L})]}),e.jsx(Le,{className:"h-5 w-5 text-gray-500"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsx("h3",{className:"text-base font-medium text-gray-900 mb-4",children:"Activity Timeline"}),e.jsx(ls,{data:P})]}),e.jsx("div",{className:"mb-6",children:e.jsx(cs,{title:"Customer Onboarding With / Without Alert",data:Y,centerText:{label:"HIGHEST",value:Y.length>0?`${Y.reduce((a,g)=>a.value>g.value?a:g).name} ${Y.reduce((a,g)=>a.value>g.value?a:g).value}`:"No data"}})}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{className:"px-6 py-2 mt-4 bg-[#FFC727] text-black rounded-lg text-sm",children:"+ Onboard New Profile"})})]});return se==="details"&&ne?e.jsx(is,{customer:ne,onBack:ye}):se==="list"?e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-center mb-6",children:e.jsxs("button",{onClick:ye,className:"flex items-center text-gray-600 hover:text-gray-900",children:[e.jsx(et,{className:"h-5 w-5 mr-2"}),e.jsx("span",{children:"Back to Dashboard"})]})}),e.jsx("h2",{className:"text-lg font-semibold mb-4",children:H===null?"All Customers":`${H.charAt(0).toUpperCase()+H.slice(1)} Customers`}),e.jsx(os,{customers:xe(H),status:H,onViewCustomer:he})]}):pe()}const ms=({isOpen:o,onConfirm:t,onCancel:r,name:c})=>o?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-xl max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center mb-4 text-amber-600",children:[e.jsx(Xe,{className:"w-6 h-6 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Confirm Tracking"})]}),e.jsxs("p",{className:"mb-4",children:["This action will deduct ",e.jsx("span",{className:"font-bold",children:"1 credit"})," from your account to start tracking ",e.jsx("span",{className:"font-bold",children:c}),"."]}),e.jsx("p",{className:"mb-6 text-sm text-gray-600",children:"Credits are only deducted the first time you track a profile. You can pause and resume tracking at any time without additional charges."}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-100",children:"Cancel"}),e.jsx("button",{onClick:t,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Confirm"})]})]})}):null;function us({trackedResults:o,tracking:t,isLoading:r,onToggleTracking:c}){const[l,u]=s.useState(new Date().toLocaleTimeString()),[d,p]=s.useState({}),[f,x]=s.useState("name"),[j,C]=s.useState("asc"),[b,N]=s.useState(""),[I,L]=s.useState(""),[te,ae]=s.useState(""),[K,E]=s.useState(""),[z,se]=s.useState("all"),V=Se(),H=2;console.log("🔶 ActiveTracking rendered with props:",{trackedResultsLength:(o==null?void 0:o.length)||0,trackingKeys:Object.keys(t||{}),isLoading:r}),s.useEffect(()=>{console.log("🔶 ActiveTracking mount/update effect"),console.log("🔶 trackedResults details:",o),console.log("🔶 tracking details:",t),!r&&o&&u(new Date().toLocaleTimeString())},[o,t,r]);const q=a=>a>=85?"text-red-600":a>=60?"text-yellow-600":"text-green-600",ne=a=>{if(!a)return console.warn("🔶 calculateAging called with null/undefined result"),"None";const g=t==null?void 0:t[a.name];return g?g.isTracking?g.startDate?`${Math.floor((Date.now()-new Date(g.startDate).getTime())/(1e3*60*60*24))}D`:"0D":g.stopDate&&g.startDate?`${Math.floor((new Date(g.stopDate).getTime()-new Date(g.startDate).getTime())/864e5)}D`:"None":(console.warn(`🔶 No tracking info for ${a.name}`),"None")},B=Array.isArray(o)?o:[];console.log("🔶 Safe tracked results count:",B.length),B.length===0&&!r&&console.log("🔶 No tracked results and not loading");const P=a=>{f===a?C(j==="asc"?"desc":"asc"):(x(a),C("asc"))},F=a=>f!==a?null:j==="asc"?e.jsx(Ot,{className:"w-4 h-4 inline-block ml-1"}):e.jsx(st,{className:"w-4 h-4 inline-block ml-1"}),Y=()=>{ae(b),E(I),se("custom")},W=()=>{N(""),L(""),ae(""),E(""),se("all")},X=()=>z==="all"?B:B.filter(a=>{var v,y;const g=!te||((v=a.name)==null?void 0:v.toLowerCase().includes(te.toLowerCase())),T=!K||((y=a.identifiers)==null?void 0:y.toLowerCase().includes(K.toLowerCase()));return g&&T}),i=()=>[...X()].sort((T,v)=>{var le,Z;const y=(le=t==null?void 0:t[T.name])!=null&&le.isTracking?1:0;return((Z=t==null?void 0:t[v.name])!=null&&Z.isTracking?1:0)-y}).sort((T,v)=>{var G,le;const y=j==="asc"?1:-1;switch(f){case"identifiers":return y*(T.identifiers||"").localeCompare(v.identifiers||"");case"name":return y*(T.name||"").localeCompare(v.name||"");case"country":return y*(T.country||"").localeCompare(v.country||"");case"aging":const Z=ne(T).replace("D",""),ue=ne(v).replace("D","");return y*(parseInt(Z)||0)-(parseInt(ue)||0);case"blacklist":const fe=T.dataset==="onboarded"?0:1,D=v.dataset==="onboarded"?0:1;return y*(fe-D);case"risk":return y*((T.riskLevel||0)-(v.riskLevel||0));case"status":const m=(G=t==null?void 0:t[T.name])!=null&&G.isTracking?1:0,Ce=(le=t==null?void 0:t[v.name])!=null&&le.isTracking?1:0;return y*(m-Ce);case"dataset":const be=T.dataset||"",Re=v.dataset||"";return y*be.localeCompare(Re);default:return 0}}),w=a=>U(this,null,function*(){try{p(g=>ee(Q({},g),{[a.id]:!0})),yield ot(a),p(g=>ee(Q({},g),{[a.id]:!1}))}catch(g){console.error("Error generating PDF:",g),p(T=>ee(Q({},T),{[a.id]:!1})),alert("Failed to generate PDF. Please try again.")}}),J=a=>{V(`/edit-profile/${a.id}`,{state:{profile:a}})},$=i(),oe=$.length,ie=B.length,me=()=>U(this,null,function*(){if(!r){u(new Date().toLocaleTimeString());try{yield c("__refresh__",!1),console.log("🔄 Manual refresh completed")}catch(a){console.error("Error during manual refresh:",a)}}}),[xe,de]=s.useState({isOpen:!1,name:"",pendingStatus:!1}),he=(a,g)=>U(this,null,function*(){if(!g){yield c(a,g);return}if(a in t){yield c(a,g);return}de({isOpen:!0,name:a,pendingStatus:g})}),ye=()=>U(this,null,function*(){const{name:a,pendingStatus:g}=xe;de(v=>ee(Q({},v),{isOpen:!1})),yield c(a,g);const T=new CustomEvent("refresh-credits");window.dispatchEvent(T)}),pe=()=>{de({isOpen:!1,name:"",pendingStatus:!1})};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(tt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",value:b,onChange:a=>{const g=a.target.value;N(g),g.length<H},placeholder:`Search by name (min. ${H} characters)`,className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-purple-500"})]})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("input",{type:"text",value:I,onChange:a=>{L(a.target.value)},placeholder:"Search by ID",className:"px-4 py-2 rounded-lg border border-gray-200 text-sm"}),e.jsx("button",{onClick:Y,disabled:b.length>0&&b.length<H,className:`px-6 py-2 bg-[#4A1D96] text-white rounded-lg text-sm ${b.length>0&&b.length<H?"opacity-50 cursor-not-allowed":""}`,children:"APPLY"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:z==="custom"?`Showing ${oe} of ${ie} tracked items`:`Total tracked items: ${ie}`}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Last updated: ",l]})]}),e.jsxs("div",{className:"flex space-x-3",children:[z==="custom"&&e.jsx("button",{onClick:W,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg text-sm hover:bg-gray-100",children:"Clear Filter"}),e.jsxs("button",{onClick:me,className:"flex items-center space-x-2 px-4 py-2 bg-purple-100 text-purple-800 rounded-lg hover:bg-purple-200",disabled:r,children:[r?e.jsx(we,{className:"w-4 h-4 animate-spin"}):e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{children:r?"Loading...":"Refresh"})]})]})]})]}),r?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(we,{className:"w-8 h-8 animate-spin text-purple-600"})}):B.length===0?e.jsxs("div",{className:"bg-yellow-50 border border-yellow-100 p-4 rounded-md",children:[e.jsx("p",{className:"text-center text-yellow-700",children:"No tracked persons found"}),e.jsxs("p",{className:"text-center text-sm text-yellow-600 mt-2",children:["There are ",Object.keys(t||{}).length," tracking entries but no matching person records."]})]}):$.length===0&&z==="custom"?e.jsxs("div",{className:"bg-blue-50 border border-blue-100 p-4 rounded-md",children:[e.jsx("p",{className:"text-center text-blue-700",children:"No results match your search"}),e.jsxs("p",{className:"text-center text-sm text-blue-600 mt-2",children:['Try different search terms or click "Clear Filter" to see all ',ie," tracked items."]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-sm text-gray-500",children:[e.jsxs("th",{className:"pb-4 px-6 whitespace-nowrap cursor-pointer",onClick:()=>P("identifiers"),children:["CUSTOMER ",F("identifiers")]}),e.jsxs("th",{className:"pb-4 px-6 whitespace-nowrap cursor-pointer text-center",onClick:()=>P("name"),children:["FULL NAME ",F("name")]}),e.jsxs("th",{className:"pb-4 px-6 whitespace-nowrap cursor-pointer text-center",onClick:()=>P("country"),children:["NATIONALITY ",F("country")]}),e.jsxs("th",{className:"pb-4 px-6 whitespace-nowrap cursor-pointer text-center",onClick:()=>P("aging"),children:["AGING ",F("aging")]}),e.jsxs("th",{className:"pb-4 px-6 whitespace-nowrap cursor-pointer text-center",onClick:()=>P("blacklist"),children:["BLACKLIST STATUS ",F("blacklist")]}),e.jsxs("th",{className:"pb-4 px-6 whitespace-nowrap cursor-pointer text-center",onClick:()=>P("dataset"),children:["CATEGORY ",F("dataset")]}),e.jsx("th",{className:"pb-4 px-6 whitespace-nowrap text-center",children:"DOCUMENTATION"}),e.jsxs("th",{className:"pb-4 px-6 whitespace-nowrap cursor-pointer text-center",onClick:()=>P("risk"),children:["RISK RATING ",F("risk")]}),e.jsxs("th",{className:"pb-4 px-6 whitespace-nowrap cursor-pointer text-center",onClick:()=>P("status"),children:["STATUS ",F("status")]}),e.jsx("th",{className:"pb-4 px-6 whitespace-nowrap text-center",children:"TRACKING"})]})}),e.jsx("tbody",{children:$.map((a,g)=>{var T,v,y,G,le;return e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 bg-white",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(a.name||"Unknown")}`,alt:a.name||"Unknown",className:"w-8 h-8 rounded-full"}),e.jsx("span",{className:"text-sm",children:a.identifiers||"N/A"})]})}),e.jsx("td",{className:"py-4 px-6 text-sm text-center",children:a.name||"Unknown"}),e.jsx("td",{className:"py-4 px-6 text-sm text-center",children:a.country&&a.country!=="Unknown"&&a.country!=="N/A"?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("img",{src:`https://flagcdn.com/w20/${a.country.toLowerCase()}.png`,alt:a.country,className:"mr-2 h-3 rounded shadow-sm",title:a.country}),a.country]}):"-"}),e.jsx("td",{className:"py-4 px-6 text-sm text-center",children:e.jsx("span",{className:(T=t==null?void 0:t[a.name])!=null&&T.isTracking?"text-green-600":"text-red-600",children:ne(a)})}),e.jsx("td",{className:"py-4 px-6 text-center",children:a.dataset==="onboarded"?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx(Ge,{className:"w-4 h-4 text-green-500"})}),e.jsx("span",{className:"ml-2 text-xs text-green-600",children:"Not Blacklisted"})]}):e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(_e,{className:"w-4 h-4 text-red-500"})}),e.jsx("span",{className:"ml-2 text-xs text-red-600",children:"Blacklisted"})]})}),e.jsx("td",{className:"py-4 px-6 text-center",children:a.dataset?e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${a.dataset==="onboarded"?"bg-green-100 text-green-700":a.dataset.includes("peps")?"bg-yellow-100 text-yellow-700":a.dataset.includes("terrorists")?"bg-red-100 text-red-700":a.dataset.includes("sanctions")?"bg-orange-100 text-orange-700":a.dataset.includes("debarment")?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:a.dataset==="onboarded"?"Onboarded":a.dataset.includes("peps")?"PEP":a.dataset.includes("terrorists")?"Terrorist":a.dataset.includes("sanctions")?"Sanctions":a.dataset.includes("debarment")?"Debarred":a.dataset}):e.jsx("span",{children:"-"})}),e.jsx("td",{className:"py-4 px-6 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:()=>w(a),disabled:d[a.id],className:"flex items-center justify-center bg-blue-50 hover:bg-blue-100 text-blue-700 p-2 rounded-full transition-colors duration-200",title:"Download Report",children:d[a.id]?e.jsx(we,{className:"w-4 h-4 animate-spin"}):e.jsx(He,{className:"w-4 h-4"})})})}),e.jsx("td",{className:"py-4 px-6 text-center",children:e.jsxs("span",{className:`text-sm ${q(a.riskLevel||0)}`,children:[a.riskLevel||0,"%"]})}),e.jsx("td",{className:"py-4 px-6 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${(v=t==null?void 0:t[a.name])!=null&&v.isTracking?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:(y=t==null?void 0:t[a.name])!=null&&y.isTracking?"Active":"Inactive"})})}),e.jsx("td",{className:"py-4 px-6 text-center",children:e.jsxs("div",{className:"flex justify-center items-center space-x-2",children:[e.jsx("button",{onClick:()=>{var Z;return he(a.name,!((Z=t==null?void 0:t[a.name])!=null&&Z.isTracking))},className:`w-8 h-5 rounded-full flex items-center transition-colors duration-300 focus:outline-none ${(G=t==null?void 0:t[a.name])!=null&&G.isTracking?"bg-purple-500":"bg-gray-300"}`,children:e.jsx("div",{className:`w-3 h-3 rounded-full bg-white shadow-md transform transition-transform duration-300 ${(le=t==null?void 0:t[a.name])!=null&&le.isTracking?"translate-x-5":"translate-x-0.5"}`})}),e.jsx("button",{onClick:()=>J(a),className:"ml-2 p-1 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-full transition-colors duration-200",title:"Edit Profile",children:e.jsx(Rt,{className:"w-4 h-4"})})]})})]},`tracked-${g}-${a.name}`)})})]})}),e.jsx(ms,{isOpen:xe.isOpen,onConfirm:ye,onCancel:pe,name:xe.name})]})}class Ie extends s.Component{constructor(){super(...arguments);Ve(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,c){console.error("Uncaught error:",r,c)}render(){var r;return this.state.hasError?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"max-w-md w-full bg-white shadow-lg rounded-lg p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 mb-4",children:((r=this.state.error)==null?void 0:r.message)||"An unexpected error occurred"}),e.jsx("button",{onClick:()=>{this.setState({hasError:!1,error:null}),window.location.reload()},className:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700",children:"Try again"})]})}):this.props.children}}function Ee(o,t="info"){const r=new CustomEvent("debug-log-updated");window.dispatchEvent(r)}const xs=({children:o,activeSection:t="insights",deepLinkSubSection:r=null,credits:c=0,loadingCredits:l=!1,handleSidebarNavigation:u,handleDeepLinkClick:d,handleIndividualOBClick:p,handleCompanyOBClick:f})=>{var Y,W,X;const{user:x,logout:j}=ke(),C=Se(),b=Qe(),[N,I]=s.useState(t==="deepLink"),[L,te]=s.useState(c),[ae,K]=s.useState(null);s.useEffect(()=>{!l&&typeof c=="number"&&te(c)},[c,l]),s.useEffect(()=>{t!=="credits"&&t!==ae&&K(t)},[t,ae]);const E=i=>{console.log(`Navigation to: ${i}`),b.pathname==="/credits"&&i!=="credits"?C("/mainapp",{state:{activeSection:i}}):u?u(i):C("/mainapp")},z=()=>{console.log("Deep link clicked"),b.pathname==="/credits"?C("/mainapp",{state:{activeSection:"deepLink",deepLinkSubSection:"individual"}}):I(!N)},se=()=>{console.log("Individual onboarding clicked")},V=()=>{console.log("Company onboarding clicked")},H=u||E,q=d||z,ne=p||se,B=f||V,P=t==="deepLink"||N,F=()=>{t!=="credits"&&K(t),C("/credits")};return e.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[e.jsx("div",{className:"w-64 bg-[#4A1D96] text-white fixed h-screen z-10",children:e.jsxs("div",{className:"p-6 flex flex-col h-full",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"AML Checker"}),e.jsxs("nav",{className:"space-y-2 mb-24",children:[e.jsxs("button",{onClick:()=>H("insights"),className:`flex items-center space-x-3 w-full p-3 rounded-lg text-gray-300 ${t==="insights"?"bg-[#5D2BA8] text-white":"hover:bg-[#5D2BA8]"}`,children:[e.jsx(He,{className:"w-5 h-5"}),e.jsx("span",{children:"Insights"})]}),e.jsxs("button",{onClick:()=>H("activeTracking"),className:`flex items-center space-x-3 w-full p-3 rounded-lg text-gray-300 ${t==="activeTracking"?"bg-[#5D2BA8] text-white":"hover:bg-[#5D2BA8]"}`,children:[e.jsx(It,{className:"w-5 h-5"}),e.jsx("span",{children:"Screening"})]}),e.jsxs("button",{onClick:()=>H("profiles"),className:`flex items-center space-x-3 w-full p-3 rounded-lg text-gray-300 ${t==="profiles"?"bg-[#5D2BA8] text-white":"hover:bg-[#5D2BA8]"}`,children:[e.jsx(Lt,{className:"w-5 h-5"}),e.jsx("span",{children:"Search Profiles"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:q,className:`flex items-center justify-between w-full p-3 rounded-lg text-gray-300 ${P?"bg-[#5D2BA8] text-white":"hover:bg-[#5D2BA8]"}`,"aria-expanded":P,"aria-controls":"deeplink-submenu",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Pt,{className:"w-5 h-5"}),e.jsx("span",{children:"Deep Link Onboarding"})]}),e.jsx(st,{className:`w-4 h-4 transition-transform duration-200 ${P?"transform rotate-180":""}`})]}),e.jsx("div",{id:"deeplink-submenu",className:`overflow-hidden transition-all duration-300 ease-in-out ${P?"max-h-24 mt-1 opacity-100":"max-h-0 opacity-0"}`,children:e.jsxs("div",{className:"py-1 pl-4 pr-2 bg-[#421C87] rounded-lg",children:[e.jsx("button",{onClick:ne,className:`flex items-center w-full py-2 px-3 text-left text-gray-300 rounded transition-colors duration-150 ${r==="individual"?"bg-[#5D2BA8] text-white":"hover:bg-[#5D2BA8] hover:text-white"}`,children:e.jsx("span",{className:"text-sm",children:"Individual Onboarding"})}),e.jsx("button",{onClick:B,className:`flex items-center w-full py-2 px-3 text-left text-gray-300 rounded transition-colors duration-150 ${r==="company"?"bg-[#5D2BA8] text-white":"hover:bg-[#5D2BA8] hover:text-white"}`,children:e.jsx("span",{className:"text-sm",children:"Company Onboarding"})})]})})]}),e.jsxs("button",{onClick:F,className:`flex items-center space-x-3 w-full p-3 rounded-lg text-gray-300 ${t==="credits"?"bg-[#5D2BA8] text-white":"hover:bg-[#5D2BA8]"}`,children:[e.jsx(Mt,{className:"w-5 h-5"}),e.jsx("span",{children:"Manage Credits"})]})]}),e.jsx("div",{className:"mt-auto",children:e.jsxs("div",{className:"bg-[#3D1678] rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-300 flex items-center justify-center text-purple-800 font-bold mr-3",children:((Y=x==null?void 0:x.name)==null?void 0:Y.charAt(0))||((W=x==null?void 0:x.email)==null?void 0:W.charAt(0))||"U"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:(x==null?void 0:x.name)||((X=x==null?void 0:x.email)==null?void 0:X.split("@")[0])||"User"}),e.jsx("div",{className:"text-xs text-purple-300",children:(x==null?void 0:x.email)||""})]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-xs text-purple-300",children:"Credits"}),e.jsx("span",{className:"font-medium",children:l?L:c})]}),e.jsxs("button",{onClick:()=>U(void 0,null,function*(){yield j(),C("/login")}),className:"flex items-center space-x-3 w-full p-2 mt-3 rounded-lg text-gray-300 hover:bg-[#4A1D96] text-sm",children:[e.jsx($t,{className:"w-4 h-4"}),e.jsx("span",{children:"Sign Out"})]})]})})]})}),e.jsx("div",{className:"flex-1 pl-64",children:o})]})},ce=De();function ct(o){const{user:t,logout:r}=ke(),c=Se(),l=Qe(),[u,d]=s.useState([]),[p,f]=s.useState(!1),[x,j]=s.useState(""),[C,b]=s.useState(""),[N,I]=s.useState({}),[L,te]=s.useState([]),[ae,K]=s.useState(!0),[E,z]=s.useState("insights"),[se,V]=s.useState(null),[H,q]=s.useState(!1),[ne,B]=s.useState(!1);s.useEffect(()=>{l.state&&l.state.activeSection&&(console.log("Restoring section from router state:",l.state.activeSection),z(l.state.activeSection),B(!1),q(!1),K(l.state.activeSection==="insights"),window.history.replaceState({},document.title))},[l.state]);const[P,F]=s.useState([]),[Y]=s.useState({}),[W,X]=s.useState(null),[i,w]=s.useState(0),[J,$]=s.useState(0),[oe,ie]=s.useState(!1),[me,xe]=s.useState(1),[de,he]=s.useState(1),[ye,pe]=s.useState(0),a=5*60*1e3,g=2,T=2*60*1e3,v=3e3,y=s.useCallback(()=>U(this,null,function*(){if(!t)return;const n=Date.now();if(n-i<v){console.log("🔍 Refresh cooldown active, skipping fetch");return}if(console.log("🔍 Starting fetchTrackedData"),w(n),W&&Date.now()-W.timestamp<T){console.log("🔍 Using cached tracking data"),I(W.data),te(W.persons);return}f(!0);try{console.log("🔍 Fetching tracked persons data from new endpoint...");const h=yield fetch(`${ce}/tracked-persons`,{credentials:"include"});if(h.status===401){console.error("🔍 Authentication error - redirecting to login"),c("/login");return}if(!h.ok)throw console.error(`🔍 Tracked persons response error: ${h.status}`),new Error("Network response was not ok for tracked persons");const R=yield h.json();console.log("🔍 Tracked persons data from server:",R);const k=Array.isArray(R.data)?R.data:[];console.log("🔍 Tracked persons array length:",k.length);const O={};k.forEach(A=>{O[A.name]={isTracking:A.isTracking===1,startDate:A.startDate,stopDate:A.stopDate}}),console.log("🔍 Transformed tracking data:",O);const S=k.map(A=>({id:A.id,name:A.name,type:A.type||"Unknown",country:A.country||"Unknown",identifiers:A.identifiers||"N/A",riskLevel:A.riskLevel||50,sanctions:Array.isArray(A.sanctions)?A.sanctions:[],dataset:A.dataset||""}));console.log("🔍 Final tracked results:",S),console.log("🔍 Final tracked results count:",S.length),X({data:O,persons:S,timestamp:Date.now()}),console.log("🔍 Updating state with tracked results"),I(O),te(S)}catch(h){console.error("🔍 Could not fetch tracked data:",h),I({}),te([])}finally{f(!1),console.log("🔍 Completed fetchTrackedData")}}),[t,c]),G=s.useCallback(()=>U(this,null,function*(){try{const n=yield fetch(`${ce}/individualob`,{credentials:"include"}),h=yield fetch(`${ce}/companyob`,{credentials:"include"});if(!n.ok||!h.ok)throw new Error("Failed to fetch onboarded customers");const R=yield n.json(),k=yield h.json();console.log("🔍 Fetched onboarded individuals:",R),console.log("🔍 Fetched onboarded companies:",k);const O=["pending",null,void 0,""],S=R.filter(M=>O.includes(M.status)),A=k.filter(M=>O.includes(M.status));console.log("🔍 Filtered to pending individuals:",S.length),console.log("🔍 Filtered to pending companies:",A.length);const _=[...S.map(M=>({id:M.id,name:M.full_name,type:"individual",isMatched:!1,status:M.status})),...A.map(M=>({id:M.id,name:M.company_name,type:"company",isMatched:!1,status:M.status}))];if(_.length>0){const M=_.map(re=>U(this,null,function*(){try{const Te=yield fetch(`${ce}/persons/search?searchTerm=${encodeURIComponent(re.name)}`,{credentials:"include"});if(!Te.ok)return re;const Ke=(yield Te.json()).data||[];return ee(Q({},re),{isMatched:Ke.length>0,matches:Ke})}catch(Te){return console.error(`Error checking matches for ${re.name}:`,Te),re}})),ve=yield Promise.all(M),Ne=ve.filter(re=>!re.isMatched);console.log(`🔍 Found ${Ne.length} customers with no matches to auto-process`);for(const re of Ne)try{console.log(`🔄 Auto-approving customer with no matches: ${re.name}`),yield fetch(`${ce}/customer/${re.type}/${re.id}/approve`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}}),console.log(`✅ Auto-approved ${re.type} ${re.name}`)}catch(Te){console.error(`Error auto-approving no-match customer ${re.name}:`,Te)}Ne.length>0&&y();const Ye=ve.filter(re=>re.isMatched&&O.includes(re.status));F(Ye),console.log("🔍 Pending approvals with match status:",Ye)}else F([])}catch(n){console.error("Error fetching pending approvals:",n),F([])}}),[ce,y]);s.useEffect(()=>{console.log("Fetching tracked data..."),y(),G();const n=setInterval(()=>{y(),G()},T);return()=>clearInterval(n)},[y,G]),console.log("MainApp render state:",{activeSection:E,trackedResults:L,tracking:N,isLoading:p}),s.useEffect(()=>{l.state&&l.state.activeSection&&(console.log("Restoring section from router state:",l.state.activeSection),z(l.state.activeSection),B(!1),q(!1),K(l.state.activeSection==="insights"),window.history.replaceState({},document.title))},[l.state]);const le=s.useCallback((n,h)=>U(this,null,function*(){var R;try{if(n==="__refresh__"){console.log("🔄 Refreshing data via special refresh command"),X(null),yield y();return}const k=Q({},N);k[n]=ee(Q({},k[n]),{isTracking:h,startDate:h?new Date().toISOString():void 0,stopDate:h?void 0:new Date().toISOString()}),I(k);const O=L.filter(A=>{var _;return(_=k[A.name])==null?void 0:_.isTracking});te(O);const S=yield fetch(`${ce}/tracking/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({isTracking:h}),credentials:"include"});if(!S.ok){if(S.status===401){c("/login");return}throw new Error(`Server error: ${S.status}`)}W&&X(ee(Q({},W),{data:k,persons:O,timestamp:Date.now()})),h&&!((R=N[n])!=null&&R.isTracking)&&setTimeout(()=>{console.log("Refreshing credits after starting tracking"),je()},500)}catch(k){console.error("Error updating tracking:",k),yield y()}}),[N,L,W,c]),Z=s.useCallback((n,h=!0)=>{if(console.log(`🔄 Tab change request to: ${n}, refresh: ${h}`),z(n),B(!1),q(!1),K(n==="insights"),n==="activeTracking"&&h){console.log("🔄 Switching to Screening tab - fetching fresh data");const R=Date.now();if(R-i<v){console.log("🔄 Refresh cooldown active, skipping data refresh");return}w(R),X(null),f(!0),y(),G()}},[y,i,G]),ue=(n,h,R,k,O)=>U(this,null,function*(){try{console.log(`🔄 ${O==="approved"?"Approving":"Rejecting"} match ${k} (ID: ${R}) for ${h} (ID: ${n})`);const S=[...P],A=S.findIndex(_=>_.id===n&&_.type===h);if(A===-1)return;if(S[A].processedMatches||(S[A].processedMatches={}),S[A].processedMatches[R]=O,F(S),O==="approved"){yield fetch(`${ce}/tracking/${k}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({isTracking:!0}),credentials:"include"}),yield fetch(`${ce}/mark-matched/${R}`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataset:"matched"})}).catch(M=>{console.error("Error marking as matched:",M),Ee(`Failed to mark ${k} as matched: ${M}`,"error")}),y(),yield fetch(`${ce}/customer/${h}/${n}/approve`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});const _=P.filter(M=>!(M.id===n&&M.type===h));F(_),alert(`${k} has been approved and added to tracking`);return}else if(O==="rejected"){console.log(`Rejecting match ${k} for customer ID ${n}`),Ee(`Rejecting match ${k} for customer ID ${n}`,"info");try{Ee(`Sending rejection request to ${ce}/customer/${h}/${n}/reject`,"info");const _=yield fetch(`${ce}/customer/${h}/${n}/reject`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}}),M=yield _.json();if(console.log("Rejection response:",M),Ee(`Server response: ${JSON.stringify(M)}`,_.ok?"success":"error"),!_.ok)throw new Error(M.message||`Server error: ${_.status}`);F(ve=>ve.filter(Ne=>!(Ne.id===n&&Ne.type===h))),Ee(`Successfully removed customer ${n} from approvals list`,"success"),alert("Customer has been rejected successfully")}catch(_){console.error("Error during rejection:",_),Ee(`Rejection error: ${_ instanceof Error?_.message:"Unknown error"}`,"error"),alert(`Failed to reject: ${_ instanceof Error?_.message:"Unknown error"}`)}}}catch(S){console.error(`Error processing match with action '${O}':`,S),alert("Failed to process match. Please try again.")}}),fe=s.useCallback((n=1)=>U(this,null,function*(){var k,O;if(!x&&!C||x&&x.length<g){d([]),he(1),pe(0);return}const h=`${x}-${C}-page${n}`,R=Y[h];if(R&&Date.now()-R.timestamp<a){d(R.results||[]),he(R.totalPages||1),pe(R.totalResults||0),xe(n);return}f(!0);try{const S=new URL(`${ce}/persons/search`);x&&S.searchParams.append("searchTerm",x),C&&S.searchParams.append("searchId",C),S.searchParams.append("page",n.toString()),S.searchParams.append("limit","50");const A=yield fetch(S.toString(),{credentials:"include"});if(!A.ok){if(A.status===401){c("/login");return}throw new Error(`HTTP error! status: ${A.status}`)}const _=yield A.json(),M=Array.isArray(_.data)?_.data:[],ve=((k=_.pagination)==null?void 0:k.totalPages)||1,Ne=((O=_.pagination)==null?void 0:O.total)||0;Y[h]={results:M,timestamp:Date.now(),totalPages:ve,totalResults:Ne},d(M),he(ve),pe(Ne),xe(n),console.log("Search results:",M.length,"Page:",n,"Total pages:",ve)}catch(S){console.error("Search failed:",S),d([]),he(1),pe(0)}finally{f(!1)}}),[x,C,Y,c]),D=s.useCallback(ss(()=>fe(1),300),[fe]),m=n=>{n>=1&&n<=de&&fe(n)};s.useEffect(()=>(D(),()=>{D.cancel()}),[x,C,D]);const Ce=()=>{E==="deepLink"?(ge("insights"),V(null)):(ge("deepLink"),V("individual"),q(!0),B(!1))},be=()=>{V("individual"),q(!0),B(!1),K(!1),z("deepLink")},Re=()=>{V("company"),B(!0),q(!1),K(!1),z("deepLink")},ge=s.useCallback(n=>{console.log(`Navigation via sidebar to: ${n}`),Z(n,!1),window.history.pushState({},document.title,"/mainapp")},[Z]);s.useEffect(()=>{const n=new URLSearchParams(window.location.search),h=n.get("section"),R=n.get("refresh")==="true";if(h){console.log("📊 Handling navigation from URL parameters");const O=Date.now(),S=R&&O-i>v;Z(h,S),S&&h==="activeTracking"&&(console.log("📊 Refreshing tracked data after profile update (URL params)"),X(null),f(!0),y(),G(),w(O)),window.history.replaceState({},document.title,"/mainapp");return}const k=l.state||{};if(k.activeSection){console.log("📊 Handling navigation with state:",k);const O=Date.now(),S=k.refreshData===!0&&O-i>v;if(k.activeSection==="deepLink"){z("deepLink");const A=k.deepLinkSubSection||"individual";V(A),q(A==="individual"),B(A==="company"),K(!1)}else Z(k.activeSection,S);S&&k.activeSection==="activeTracking"&&(console.log("📊 Refreshing tracked data after profile update"),X(null),f(!0),y(),G(),w(O)),window.history.replaceState({},document.title)}},[l,Z,y,G,i]);const je=s.useCallback(()=>U(this,null,function*(){if(t){ie(!0);try{console.log("Fetching credits for user:",t.id);const n=yield fetch(`${ce}/credits`,{credentials:"include"});if(!n.ok)throw new Error(`Failed to fetch credits: ${n.status}`);const h=yield n.json();if(console.log("Credits data received:",h),typeof h.credits=="number")$(h.credits);else{console.error("Invalid credits data received:",h);const R=parseInt(h.credits);$(isNaN(R)?0:R)}}catch(n){console.error("Error fetching credits:",n),$(0)}finally{ie(!1)}}}),[t,ce]);return s.useEffect(()=>{je();const n=setInterval(()=>{je()},3e4),h=()=>{console.log("Refreshing credits from custom event"),je()};return window.addEventListener("refresh-credits",h),()=>{clearInterval(n),window.removeEventListener("refresh-credits",h)}},[je,E]),s.useEffect(()=>{P.length>0&&je()},[P,je]),e.jsx(xs,{activeSection:E,deepLinkSubSection:se,credits:J,loadingCredits:oe,handleSidebarNavigation:ge,handleDeepLinkClick:Ce,handleIndividualOBClick:be,handleCompanyOBClick:Re,children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("header",{className:"bg-white border-b border-gray-200",children:[e.jsx("div",{className:"flex justify-between items-center px-6 py-4",children:e.jsx("h2",{className:"text-xl font-semibold",children:ae?"Activity Dashboard":H?"Individual Onboarding":ne?"Company Onboarding":E==="activeTracking"?"Screening":"Search"})}),!ae&&!H&&!ne&&E!=="activeTracking"&&e.jsxs("div",{className:"px-6 py-3 flex items-center space-x-4 border-t border-gray-200",children:[e.jsx("div",{className:"flex space-x-2",children:e.jsx("button",{className:"px-4 py-1 rounded-full bg-[#4A1D96] text-white text-sm",children:"All"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(tt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",value:x,onChange:n=>{const h=n.target.value;j(h),h.length<g&&d([])},placeholder:`Search by name (min. ${g} characters)`,className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-purple-500"})]})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("input",{type:"text",value:C,onChange:n=>{b(n.target.value)},placeholder:"Search by ID",className:"px-4 py-2 rounded-lg border border-gray-200 text-sm"}),e.jsx("button",{onClick:()=>fe(),disabled:x.length>0&&x.length<g,className:`px-6 py-2 bg-[#4A1D96] text-white rounded-lg text-sm ${x.length>0&&x.length<g?"opacity-50 cursor-not-allowed":""}`,children:"APPLY"})]})]})]}),ae?e.jsx(Ie,{children:e.jsx(ds,{})}):H?e.jsx(Ie,{children:e.jsx(ns,{})}):ne?e.jsx(Ie,{children:e.jsx(rs,{})}):E==="activeTracking"?e.jsx(Ie,{children:e.jsxs("div",{children:[P.filter(n=>n.isMatched).length>0&&e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Customers Requiring Approval"}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Matches"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.filter(n=>n.isMatched).map(n=>e.jsx(yt.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:n.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:n.type==="individual"?"Individual":"Company"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:"Potential Match Found"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:n.matches&&n.matches.length>0&&e.jsxs("details",{className:"cursor-pointer",children:[e.jsxs("summary",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold",children:[n.matches.length," potential ",n.matches.length===1?"match":"matches"]}),e.jsx(_t,{className:"h-4 w-4 ml-2 text-purple-500"})]}),e.jsxs("div",{className:"mt-3 p-4 bg-gray-50 rounded-md border border-gray-200",children:[e.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Match Details:"}),e.jsx("ul",{className:"space-y-2",children:n.matches.map((h,R)=>{var k,O,S;return e.jsxs("li",{className:`p-2 border-b border-gray-200 last:border-0 ${((k=n.processedMatches)==null?void 0:k[h.id])==="approved"?"bg-green-50":((O=n.processedMatches)==null?void 0:O[h.id])==="rejected"?"bg-red-50":""}`,children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:h.name}),e.jsxs("span",{className:`px-2 py-1 text-xs rounded-full ${h.riskLevel>=85?"bg-red-100 text-red-800":h.riskLevel>=65?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:["Risk: ",h.riskLevel,"%"]})]}),e.jsxs("div",{className:"mt-1 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",h.type]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Country:"})," ",h.country]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"ID:"})," ",h.identifiers]})]}),(S=n.processedMatches)!=null&&S[h.id]?e.jsx("div",{className:"mt-2 text-sm italic",children:n.processedMatches[h.id]==="approved"?e.jsx("span",{className:"text-green-600",children:"✓ Approved - Added to tracking"}):e.jsx("span",{className:"text-red-600",children:"✗ Rejected"})}):e.jsxs("div",{className:"mt-2 flex justify-end space-x-2",children:[e.jsxs("button",{onClick:()=>ue(n.id,n.type,h.id,h.name,"approved"),className:"px-3 py-1 bg-green-100 text-green-800 rounded-md text-xs flex items-center hover:bg-green-200",children:[e.jsx(Ge,{className:"w-3 h-3 mr-1"}),"Approve Match"]}),e.jsxs("button",{onClick:()=>ue(n.id,n.type,h.id,h.name,"rejected"),className:"px-3 py-1 bg-red-100 text-red-800 rounded-md text-xs flex items-center hover:bg-red-200",children:[e.jsx(_e,{className:"w-3 h-3 mr-1"}),"Reject Match"]})]})]},`match-${h.id}-${R}`)})})]})]})})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsxs("button",{onClick:()=>ue(n.id,n.type,n.id,n.name,"approved"),className:"text-green-600 hover:text-green-900 mr-4",children:[e.jsx(Ge,{className:"inline w-5 h-5 mr-1"}),"Approve"]}),e.jsxs("button",{onClick:()=>ue(n.id,n.type,n.id,n.name,"rejected"),className:"text-red-600 hover:text-red-900",children:[e.jsx(_e,{className:"inline w-5 h-5 mr-1"}),"Reject"]})]})]})},`${n.type}-${n.id}`))})]})})]}),e.jsx(us,{trackedResults:L,tracking:N,isLoading:p,onToggleTracking:le})]})}):e.jsx(Ie,{children:e.jsxs("div",{className:"p-6",children:[p&&e.jsxs("div",{className:"flex items-center text-purple-700 mb-6",children:[e.jsx(we,{className:"w-5 h-5 mr-2 animate-spin"}),e.jsx("span",{children:"Searching..."})]}),!p&&x.length<g&&u.length===0&&e.jsx("div",{className:"text-center p-12",children:e.jsxs("p",{className:"text-gray-500 mb-4",children:["Enter at least ",g," characters to search for profiles"]})}),!p&&x.length>=g&&u.length===0&&e.jsx("div",{className:"text-center p-12",children:e.jsxs("p",{className:"text-gray-500 mb-4",children:['No results found for "',x,'"']})}),u.length>0&&e.jsx(es,{searchResults:u,isLoading:!1,currentPage:me,totalPages:de,totalResults:ye,onPageChange:m})]})})]})})}const Ts=Object.freeze(Object.defineProperty({__proto__:null,default:ct},Symbol.toStringTag,{value:"Module"})),hs=s.lazy(()=>Pe(()=>import("./Login-edTm9vRp.js"),__vite__mapDeps([0,1,2,3,4]))),ps=s.lazy(()=>Pe(()=>import("./Register-CEdC8mq8.js"),__vite__mapDeps([5,2,1,3,4]))),gs=s.lazy(()=>Pe(()=>import("./EditProfile-y_hD3dT9.js"),__vite__mapDeps([6,2,3,1,4]))),fs=s.lazy(()=>Pe(()=>import("./Credits-DW5icCfA.js"),__vite__mapDeps([7,2,3,1,4]))),dt=()=>e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"w-12 h-12 border-4 border-purple-600 border-t-transparent rounded-full animate-spin"})}),bs=o=>{o()},ys=()=>{const{isAuthenticated:o}=ke();return s.useEffect(()=>{if(o){const t=setTimeout(()=>{bs(()=>Pe(()=>import("./EditProfile-y_hD3dT9.js"),__vite__mapDeps([6,2,3,1,4])))},2e3);return()=>clearTimeout(t)}},[o]),null};function Fe({children:o}){const{isAuthenticated:t,loading:r}=ke();return r?e.jsx(dt,{}):t?o:e.jsx(vt,{to:"/login",replace:!0})}function js(){return e.jsx(jt,{children:e.jsxs(Qt,{children:[e.jsx(ys,{}),e.jsx(s.Suspense,{fallback:e.jsx(dt,{}),children:e.jsxs(Nt,{children:[e.jsx(Ae,{path:"/login",element:e.jsx(hs,{})}),e.jsx(Ae,{path:"/register",element:e.jsx(ps,{})}),e.jsx(Ae,{path:"/mainapp",element:e.jsx(Fe,{children:e.jsx(ct,{})})}),e.jsx(Ae,{path:"/edit-profile/:id",element:e.jsx(Fe,{children:e.jsx(gs,{})})}),e.jsx(Ae,{path:"/credits",element:e.jsx(Fe,{children:e.jsx(fs,{})})}),e.jsx(Ae,{path:"/*",element:null})]})})]})})}Zt.createRoot(document.getElementById("root")).render(e.jsx(s.StrictMode,{children:e.jsx(js,{})}));export{xs as L,Ts as M,De as a,lt as g,e as j,it as s,ke as u};
//# sourceMappingURL=index-D4FcVlNj.js.map
