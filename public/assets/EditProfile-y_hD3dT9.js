var y=(l,m,r)=>new Promise((H,i)=>{var g=n=>{try{c(r.next(n))}catch(d){i(d)}},x=n=>{try{c(r.throw(n))}catch(d){i(d)}},c=n=>n.done?H(n.value):Promise.resolve(n.value).then(g,x);c((r=r.apply(l,m)).next())});import{g as ve,u as Se,a as we,j as e,L as Ee,s as Ce}from"./index-D4FcVlNj.js";import{u as Oe,h as ke,d as Ie,r as o}from"./vendor-W07s9AD9.js";import{L as fe}from"./ui-DWVAqNqj.js";import"./pdf-C06UDWxx.js";import"./charts-DvSD_8Tn.js";function Ue(){var pe;const l=we(),m=Oe(),{id:r}=ke(),i=(pe=Ie().state)==null?void 0:pe.profile,[g,x]=o.useState(!0),[c,n]=o.useState(""),[d,N]=o.useState(""),[W,j]=o.useState(""),[_,v]=o.useState(""),[X,S]=o.useState(""),[Z,w]=o.useState(""),[p,E]=o.useState(""),[f,h]=o.useState(!1),[q,C]=o.useState(""),[J,O]=o.useState(""),[K,k]=o.useState(""),[V,I]=o.useState(""),[Q,T]=o.useState(""),[ee,P]=o.useState(""),[te,D]=o.useState(""),[se,R]=o.useState(""),[oe,A]=o.useState(""),[ae,L]=o.useState(""),[re,F]=o.useState(""),[ne,U]=o.useState(""),[ie,B]=o.useState(""),[le,Y]=o.useState(""),[de,$]=o.useState(""),[ce,M]=o.useState(""),[ue,z]=o.useState(""),[he,me]=o.useState(0),[be,ge]=o.useState(!1),G=ve(),xe=p?Ce[p]||[]:[],{user:Te}=Se();o.useEffect(()=>{y(this,null,function*(){try{if(i){n(i.name||""),O(i.identifiers||"");const a=yield fetch(`${l}/profile/${r}`,{credentials:"include"});if(a.ok){const s=yield a.json();N(s.email||""),j(s.residentStatus||""),v(s.gender||""),S(s.dateOfBirth?new Date(s.dateOfBirth).toISOString().split("T")[0]:""),w(s.nationality||""),E(s.countryOfResidence||""),h(s.otherNationalities||!1),C(s.specifiedOtherNationalities||""),k(s.nationalIdExpiry?new Date(s.nationalIdExpiry).toISOString().split("T")[0]:""),I(s.passportNumber||""),T(s.passportExpiry?new Date(s.passportExpiry).toISOString().split("T")[0]:""),P(s.address||""),D(s.state||""),R(s.city||""),A(s.zipCode||""),L(s.contactNumber||""),F(s.dialingCode||""),U(s.workType||""),B(s.industry||""),Y(s.productTypeOffered||""),$(s.productOffered||""),M(s.companyName||""),z(s.positionInCompany||"")}else console.error("Failed to fetch profile data")}else if(r){const a=yield fetch(`${l}/profile/${r}`,{credentials:"include"});if(a.ok){const s=yield a.json();n(s.fullName||s.name||""),N(s.email||""),j(s.residentStatus||""),v(s.gender||""),S(s.dateOfBirth?new Date(s.dateOfBirth).toISOString().split("T")[0]:""),w(s.nationality||""),E(s.countryOfResidence||""),h(s.otherNationalities||!1),C(s.specifiedOtherNationalities||""),O(s.nationalIdNumber||s.identifiers||""),k(s.nationalIdExpiry?new Date(s.nationalIdExpiry).toISOString().split("T")[0]:""),I(s.passportNumber||""),T(s.passportExpiry?new Date(s.passportExpiry).toISOString().split("T")[0]:""),P(s.address||""),D(s.state||""),R(s.city||""),A(s.zipCode||""),L(s.contactNumber||""),F(s.dialingCode||""),U(s.workType||""),B(s.industry||""),Y(s.productTypeOffered||""),$(s.productOffered||""),M(s.companyName||""),z(s.positionInCompany||"")}else alert("Failed to fetch profile data"),m("/mainapp")}else alert("No profile selected for editing"),m("/mainapp")}catch(a){console.error("Error fetching profile data:",a),alert("An error occurred while loading profile data")}finally{x(!1)}})},[r,i,l,m]),o.useEffect(()=>{y(this,null,function*(){try{ge(!0);const a=yield fetch(`${l}/credits`,{credentials:"include"});if(a.ok){const s=yield a.json();if(typeof s.credits=="number")me(s.credits);else{const b=parseInt(s.credits);me(isNaN(b)?0:b)}}}catch(a){console.error("Error fetching credits:",a)}finally{ge(!1)}})},[l]);const ye=t=>y(this,null,function*(){if(t.preventDefault(),!c||!d){alert("Full Name and Email are required.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d)){alert("Invalid email format.");return}const s=u=>u?new Date(u).toISOString().split("T")[0]:null,b={id:r,originalName:i==null?void 0:i.name,fullName:c,email:d,residentStatus:W,gender:_,dateOfBirth:s(X),nationality:Z,countryOfResidence:p,otherNationalities:f,specifiedOtherNationalities:q,nationalIdNumber:J,nationalIdExpiry:s(K),passportNumber:V,passportExpiry:s(Q),address:ee,state:te,city:se,zipCode:oe,contactNumber:ae,dialingCode:re,workType:ne,industry:ie,productTypeOffered:le,productOffered:de,companyName:ce,positionInCompany:ue};try{x(!0);const u=yield fetch(`${l}/updateProfile/${r}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b),credentials:"include"}),Ne=yield u.json();if(u.ok){alert("Profile updated successfully!");const je=new URLSearchParams({section:"activeTracking",refresh:"true",t:Date.now().toString()});window.location.href=`/mainapp?${je.toString()}`}else alert(Ne.message||"Update failed")}catch(u){console.error("Error updating profile:",u),alert("An error occurred during submission. Please try again.")}finally{x(!1)}});return e.jsx(Ee,{credits:he,loadingCredits:be,children:e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Edit Profile"}),g?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(fe,{className:"w-8 h-8 animate-spin text-purple-600"})}):e.jsxs("form",{onSubmit:ye,className:"grid grid-cols-1 md:grid-cols-3 gap-6 bg-white p-6 rounded-lg shadow",children:[e.jsx("div",{className:"md:col-span-3",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Personal Information"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"FULL NAME"}),e.jsx("input",{type:"text",value:c,onChange:t=>n(t.target.value),placeholder:"Enter full name",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"EMAIL"}),e.jsx("input",{type:"email",value:d,onChange:t=>N(t.target.value),placeholder:"Enter email",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"RESIDENT STATUS"}),e.jsxs("select",{value:W,onChange:t=>j(t.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select Resident Status"}),e.jsx("option",{value:"citizen",children:"Citizen"}),e.jsx("option",{value:"resident",children:"Resident"}),e.jsx("option",{value:"non-resident",children:"Non-Resident"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"GENDER"}),e.jsxs("select",{value:_,onChange:t=>v(t.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"DATE OF BIRTH"}),e.jsx("input",{type:"date",value:X,onChange:t=>S(t.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"NATIONALITY"}),e.jsxs("select",{value:Z,onChange:t=>w(t.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select Nationality"}),G.map(t=>e.jsx("option",{value:t.code,children:t.name},`nat-${t.code}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"COUNTRY OF RESIDENCE"}),e.jsxs("select",{value:p,onChange:t=>E(t.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select Country of Residence"}),G.map(t=>e.jsx("option",{value:t.code,children:t.name},`res-${t.code}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"DO YOU HAVE OTHER NATIONALITIES?"}),e.jsxs("div",{className:"mt-1 flex space-x-4",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"yes",checked:f===!0,onChange:()=>h(!0),className:"form-radio h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"}),e.jsx("span",{className:"ml-2",children:"Yes"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"no",checked:f===!1,onChange:()=>h(!1),className:"form-radio h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"}),e.jsx("span",{className:"ml-2",children:"No"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"SPECIFY OTHER NATIONALITIES (IF APPLICABLE)"}),e.jsxs("select",{value:q,onChange:t=>C(t.target.value),disabled:!f,className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"",children:"Select Other Nationalities"}),G.map(t=>e.jsx("option",{value:t.code,children:t.name},`other-${t.code}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"NATIONAL ID NUMBER"}),e.jsx("input",{type:"text",value:J,onChange:t=>O(t.target.value),placeholder:"Enter National ID Number",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"NATIONAL ID EXPIRY"}),e.jsx("input",{type:"date",value:K,onChange:t=>k(t.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"PASSPORT NUMBER"}),e.jsx("input",{type:"text",value:V,onChange:t=>I(t.target.value),placeholder:"Enter Passport Number",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"PASSPORT EXPIRY"}),e.jsx("input",{type:"date",value:Q,onChange:t=>T(t.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsx("div",{className:"md:col-span-3 mt-6",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Contact Information"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"ADDRESS"}),e.jsx("input",{type:"text",value:ee,onChange:t=>P(t.target.value),placeholder:"Enter address",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"STATE"}),e.jsxs("select",{value:te,onChange:t=>D(t.target.value),disabled:!p||xe.length===0,className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"",children:"Select State"}),xe.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"CITY"}),e.jsx("input",{type:"text",value:se,onChange:t=>R(t.target.value),placeholder:"Enter city",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"ZIP CODE/POSTAL CODE"}),e.jsx("input",{type:"text",value:oe,onChange:t=>A(t.target.value),placeholder:"Enter zip code",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"DIALING CODE"}),e.jsx("input",{type:"text",value:re,onChange:t=>F(t.target.value),placeholder:"e.g., +1",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"CONTACT NUMBER"}),e.jsx("input",{type:"tel",value:ae,onChange:t=>L(t.target.value),placeholder:"Enter phone number",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsx("div",{className:"md:col-span-3 mt-6",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Profile Information"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"WORK TYPE"}),e.jsxs("select",{value:ne,onChange:t=>U(t.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select Work Type"}),e.jsx("option",{value:"employee",children:"Employee"}),e.jsx("option",{value:"contractor",children:"Contractor"}),e.jsx("option",{value:"freelancer",children:"Freelancer"}),e.jsx("option",{value:"business_owner",children:"Business Owner"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"INDUSTRY"}),e.jsxs("select",{value:ie,onChange:t=>B(t.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select Industry"}),e.jsx("option",{value:"finance",children:"Finance"}),e.jsx("option",{value:"technology",children:"Technology"}),e.jsx("option",{value:"healthcare",children:"Healthcare"}),e.jsx("option",{value:"education",children:"Education"}),e.jsx("option",{value:"retail",children:"Retail"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"PRODUCT TYPE OFFERED TO CUSTOMER"}),e.jsxs("select",{value:le,onChange:t=>Y(t.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select Product Type"}),e.jsx("option",{value:"goods",children:"Physical Goods"}),e.jsx("option",{value:"services",children:"Services"}),e.jsx("option",{value:"digital",children:"Digital Products"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"PRODUCT OFFERED"}),e.jsx("input",{type:"text",value:de,onChange:t=>$(t.target.value),placeholder:"Enter Product Offered",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"COMPANY NAME"}),e.jsx("input",{type:"text",value:ce,onChange:t=>M(t.target.value),placeholder:"Enter Company Name",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"POSITION IN COMPANY"}),e.jsx("input",{type:"text",value:ue,onChange:t=>z(t.target.value),placeholder:"Enter Position in Company",className:"mt-1 block w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsx("div",{className:"md:col-span-3",children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{type:"submit",className:"mt-4 px-6 py-2 bg-[#4A1D96] text-white rounded-lg hover:bg-[#3c177d] focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50",disabled:g,children:g?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-4 h-4 mr-2 inline animate-spin"}),"UPDATING..."]}):"UPDATE PROFILE"}),e.jsx("button",{type:"button",onClick:()=>{const t=new URLSearchParams({section:"activeTracking",t:Date.now().toString()});window.location.href=`/mainapp?${t.toString()}`},className:"mt-4 px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50",children:"CANCEL"})]})})]})]})})}export{Ue as default};
//# sourceMappingURL=EditProfile-y_hD3dT9.js.map
